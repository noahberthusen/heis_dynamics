(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     81077,       1932]
NotebookOptionsPosition[     74016,       1816]
NotebookOutlinePosition[     74357,       1831]
CellTagsIndexPosition[     74314,       1828]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Variational strategy for the time-evolution of a local observable\
\>", "Title",
 CellChangeTimes->{{3.82068728244985*^9, 
  3.8206873047440825`*^9}},ExpressionUUID->"42157d35-70ac-4fca-84ed-\
df6dcd0d8204"],

Cell["\<\
Calculating the matrix A  (see Notes_Thais/Local_op_variational.pdf)\
\>", "Subtitle",
 CellChangeTimes->{{3.8206874814421988`*^9, 
  3.82068754144462*^9}},ExpressionUUID->"7fe78ad0-52c0-4516-8f38-\
f54265dfcd27"],

Cell[CellGroupData[{

Cell["Functions (from TI\[CloseCurlyQuote]s Mathematica)", "Section",
 CellChangeTimes->{{3.820687818304344*^9, 3.820687849544361*^9}, {
  3.820687889580441*^9, 
  3.8206878896443048`*^9}},ExpressionUUID->"bb7c3038-a6b7-4ffd-88af-\
268d2575ecdf"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.765710166393487*^9, 
  3.765710180280023*^9}},ExpressionUUID->"f35adfce-c601-4ef0-9f73-\
f0ee369a01aa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FlipFlop", "[", 
   RowBox[{"n_", ",", "i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v", "=", 
      RowBox[{"IntegerDigits", "[", 
       RowBox[{"n", ",", "2", ",", "L"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "\[NotEqual]", "0"}], "&&", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "\[NotEqual]", "1"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "-", "1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "+", "1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"FromDigits", "[", 
        RowBox[{"v", ",", "2"}], "]"}]}], "\[IndentingNewLine]", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"-", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Raise", "[", 
   RowBox[{"n_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v", "=", 
      RowBox[{"IntegerDigits", "[", 
       RowBox[{"n", ",", "2", ",", "L"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"[", 
         RowBox[{"Mod", "[", 
          RowBox[{"i", ",", "L", ",", "1"}], "]"}], "]"}], "]"}], 
       "\[NotEqual]", "1"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "+", "1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"FromDigits", "[", 
        RowBox[{"v", ",", "2"}], "]"}]}], "\[IndentingNewLine]", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"-", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "[", 
   RowBox[{"t_", ",", "e_", ",", "v_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Transpose", "[", "v", "]"}], ".", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "e", " ", "t"}], "]"}], "]"}], ".", 
   RowBox[{"Conjugate", "[", "v", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.7655395073253803`*^9, 3.765539526822287*^9}, 
   3.7655404443969593`*^9, {3.765542375955605*^9, 3.765542395574185*^9}, {
   3.765542503282773*^9, 3.7655425108017397`*^9}, {3.7655427089217377`*^9, 
   3.765542717666914*^9}, {3.7655430607762747`*^9, 3.76554306089671*^9}, {
   3.76589530850611*^9, 3.765895308783208*^9}, {3.8135865636772413`*^9, 
   3.8135865642974653`*^9}, {3.813587206846246*^9, 3.813587230540331*^9}, {
   3.813592068652861*^9, 3.813592068830264*^9}, {3.813594393849374*^9, 
   3.813594397977915*^9}, {3.813594443293139*^9, 3.813594462812553*^9}, {
   3.816606089527637*^9, 3.816606096840437*^9}, {3.8166067889361267`*^9, 
   3.81660679307829*^9}, {3.816608819271003*^9, 3.816608822964926*^9}, {
   3.8166117140653152`*^9, 3.8166117200423937`*^9}, {3.816612035421781*^9, 
   3.8166120403160477`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"14bb87d6-f6b4-46f3-a741-0236d3ea3d3c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"L", "=", "5"}], ";"}]], "Input",
 CellChangeTimes->{{3.765538817188937*^9, 3.765538820613866*^9}, {
   3.76553924686829*^9, 3.765539246946069*^9}, {3.765539292995078*^9, 
   3.7655392930589*^9}, {3.765539328444461*^9, 3.765539330208981*^9}, 
   3.765556581500142*^9, 3.76555666555637*^9, {3.765556808307291*^9, 
   3.7655568090371323`*^9}, 3.765564057088217*^9, {3.765710261306361*^9, 
   3.765710261454471*^9}, 3.76572838951164*^9, 3.765895319889732*^9, {
   3.765897875218302*^9, 3.765897875384502*^9}, 3.7659011870330677`*^9, 
   3.766315350352639*^9, 3.766327918955817*^9, 3.766404137569581*^9, {
   3.7664175746258545`*^9, 3.7664175747147245`*^9}, {3.766423389207467*^9, 
   3.766423389380169*^9}, 3.766510349459014*^9, {3.766512201302676*^9, 
   3.766512201546687*^9}, {3.7667631322787933`*^9, 3.7667631327675076`*^9}, {
   3.766763409034783*^9, 3.766763461133748*^9}, 3.766763937562231*^9, 
   3.7729881146509714`*^9, 3.77298885399009*^9, 3.773056211876685*^9, 
   3.773056787349367*^9, 3.7730569147126975`*^9, 3.779098747672633*^9, {
   3.779099582067582*^9, 3.77909958227472*^9}, 3.8135865402804003`*^9, 
   3.813587137997987*^9, 3.8135874154746304`*^9, 3.81359281566432*^9, {
   3.81359303312822*^9, 3.81359303324481*^9}, {3.8135932698872843`*^9, 
   3.813593282777891*^9}, 3.813593495159255*^9, {3.813594526949836*^9, 
   3.813594527610154*^9}, 3.8135946894678183`*^9, 3.813594774618676*^9, 
   3.813594934761162*^9, {3.813600032878961*^9, 3.813600032973908*^9}, 
   3.8136058563614492`*^9, {3.8136063439628468`*^9, 3.813606344072823*^9}, {
   3.813606499369738*^9, 3.813606516749812*^9}, {3.81360660978023*^9, 
   3.813606609872326*^9}, 3.813606763260933*^9, {3.814114559510291*^9, 
   3.814114559938724*^9}, 3.814115815308709*^9, {3.814560316272141*^9, 
   3.814560316382197*^9}, {3.8145608202744102`*^9, 3.814560820367893*^9}, 
   3.815911856233745*^9, 3.8159450474781218`*^9, {3.8166067104576187`*^9, 
   3.816606710543508*^9}, 3.8166068516891537`*^9, {3.816606891326357*^9, 
   3.816606930478354*^9}, {3.816608736817081*^9, 3.81660875968019*^9}, {
   3.816609271537735*^9, 3.816609271624645*^9}, 3.8166095850533743`*^9, {
   3.816610600279435*^9, 3.8166106003490953`*^9}, {3.816611821126563*^9, 
   3.8166118211691732`*^9}, {3.816619267429934*^9, 3.816619297050412*^9}, {
   3.816619366226264*^9, 3.816619371340807*^9}},
 Background->RGBColor[1, 1, 0.85],
 CellLabel->"In[4]:=",ExpressionUUID->"7989c289-b53d-4f67-a91c-c5993f2c9b77"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Id", "=", 
   RowBox[{"IdentityMatrix", "[", 
    SuperscriptBox["2", "L"], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Heis", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SparseArray", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Flatten", "@", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"h", "=", 
                RowBox[{"FlipFlop", "[", 
                 RowBox[{"j", ",", "i", ",", "k"}], "]"}]}], ",", 
               RowBox[{"v", "=", 
                RowBox[{
                 RowBox[{"2", 
                  RowBox[{"IntegerDigits", "[", 
                   RowBox[{"j", ",", "2", ",", "L"}], "]"}]}], "-", "1"}]}]}],
               "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"h", "\[NotEqual]", 
                RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"j", "+", "1"}], ",", 
                    RowBox[{"h", "+", "1"}]}], "}"}], "\[Rule]", "2."}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"h", "+", "1"}], ",", 
                    RowBox[{"j", "+", "1"}]}], "}"}], "\[Rule]", "2."}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"j", "+", "1"}], ",", 
                    RowBox[{"j", "+", "1"}]}], "}"}], "->", 
                  RowBox[{"N", "[", 
                   RowBox[{
                    RowBox[{"v", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "*", 
                    RowBox[{"v", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"j", "+", "1"}], ",", 
                   RowBox[{"j", "+", "1"}]}], "}"}], "\[Rule]", 
                 RowBox[{"N", "[", 
                  RowBox[{
                   RowBox[{"v", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "*", 
                   RowBox[{"v", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}], "}"}]}], 
              "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "0", ",", 
             RowBox[{
              SuperscriptBox["2", "L"], "-", "1"}]}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["2", "L"], ",", 
          SuperscriptBox["2", "L"]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "L"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sz", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SparseArray", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"v", "=", 
               RowBox[{
                RowBox[{"2", 
                 RowBox[{"IntegerDigits", "[", 
                  RowBox[{"j", ",", "2", ",", "L"}], "]"}]}], "-", "1"}]}], 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"j", "+", "1"}]}], "}"}], "\[Rule]", 
              RowBox[{"N", "[", 
               RowBox[{"v", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "0", ",", 
             RowBox[{
              SuperscriptBox["2", "L"], "-", "1"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["2", "L"], ",", 
           SuperscriptBox["2", "L"]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "L"}], "}"}]}], "]"}], ",", "i"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SzTot", "=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Sz", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "L"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sp", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SparseArray", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Block", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"h", "=", 
                 RowBox[{"Raise", "[", 
                  RowBox[{"j", ",", "i"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"h", "\[NotEqual]", 
                  RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"h", "+", "1"}], ",", 
                    RowBox[{"j", "+", "1"}]}], "}"}], "\[Rule]", "1."}]}], 
                "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
             ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "0", ",", 
               RowBox[{
                SuperscriptBox["2", "L"], "-", "1"}]}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", ",", "Null"}], "]"}], "\[IndentingNewLine]",
          ",", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["2", "L"], ",", 
           SuperscriptBox["2", "L"]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "L"}], "}"}]}], "]"}], ",", "i"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sm", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"Sp", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "L"}], "}"}]}], "]"}], ",", "i"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.76554026306886*^9, 3.7655402751049557`*^9}, {
   3.765540362866849*^9, 3.765540393945359*^9}, {3.765540547718257*^9, 
   3.765540593855013*^9}, {3.7655409690298233`*^9, 3.765541135888237*^9}, {
   3.765541181923973*^9, 3.765541190612671*^9}, {3.765541264839321*^9, 
   3.765541276424123*^9}, {3.765541331048069*^9, 3.7655413377084827`*^9}, {
   3.7655536076374283`*^9, 3.7655536616720343`*^9}, {3.765553764433598*^9, 
   3.765553821171158*^9}, {3.765553874406219*^9, 3.765553886076502*^9}, {
   3.765553926359667*^9, 3.765553930654847*^9}, 3.765553963517459*^9, {
   3.765634470309163*^9, 3.765634549159091*^9}, {3.765634597923142*^9, 
   3.765634599008275*^9}, {3.765634670828383*^9, 3.76563485202665*^9}, {
   3.765895294067505*^9, 3.7658952972454157`*^9}, {3.7658966428426237`*^9, 
   3.76589665054349*^9}, {3.7664027896553326`*^9, 3.766402842838036*^9}, {
   3.7664030062286606`*^9, 3.7664030102797575`*^9}, {3.7664030709648066`*^9, 
   3.766403072531369*^9}, {3.772988891434066*^9, 3.7729888929400015`*^9}, {
   3.773056129141179*^9, 3.7730561367692347`*^9}, {3.779099056554234*^9, 
   3.779099058837243*^9}, {3.8135865796964083`*^9, 3.813586589985237*^9}, {
   3.813586948658258*^9, 3.813586990902678*^9}, 3.813587037734062*^9, {
   3.813587240397996*^9, 3.813587240603529*^9}, {3.813587389219864*^9, 
   3.813587390529579*^9}, {3.8135874366201067`*^9, 3.813587437616737*^9}, {
   3.813591938072456*^9, 3.813591953214341*^9}, {3.813594476328452*^9, 
   3.8135945138364477`*^9}, 3.8135946176305647`*^9, 3.81359473937271*^9, {
   3.81359477913941*^9, 3.813594779232057*^9}, {3.813594996602191*^9, 
   3.813594997726571*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"404676b0-d695-4efc-ae43-3ac5a6eee47c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "Id", "]"}]], "Input",
 CellChangeTimes->{{3.8206935228779964`*^9, 3.820693526963817*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"97d2db22-b5d0-401c-818c-a8823edb1db1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"32", ",", "32"}], "}"}]], "Output",
 CellChangeTimes->{3.8206935276118965`*^9, 3.8207882542056313`*^9, 
  3.82086018275239*^9, 3.8209470985664816`*^9, 3.8211058458008356`*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"cfd86f1b-5566-414c-a3af-ccaca188233c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "Heis", "]"}]], "Input",
 CellChangeTimes->{{3.8206935287869444`*^9, 3.820693531419685*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"dcc6669e-f919-469c-b239-b9a2dbba1480"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5", ",", "5", ",", "32", ",", "32"}], "}"}]], "Output",
 CellChangeTimes->{3.820693532157711*^9, 3.8207882550609803`*^9, 
  3.820860183347799*^9, 3.8209470990310955`*^9, 3.8211058466266055`*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"0ed1294d-24cc-4286-be92-03f5f1fdb584"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Sz", "[", 
   RowBox[{"[", "5", "]"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.8211079690367575`*^9, 3.8211079758066616`*^9}, {
  3.8211080063570595`*^9, 3.8211080234915586`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"25860629-5db5-4f12-a63c-ba0b4942c2b9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1.`"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1.`", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", "1.`"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1.`", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", "1.`"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1.`", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1.`"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1.`", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1.`"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1.`", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1.`"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1.`", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1.`"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1.`", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1.`"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1.`", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", 
      RowBox[{"-", "1.`"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "1.`", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", 
      RowBox[{"-", "1.`"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "1.`", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1.`"}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "1.`", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1.`"}], "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "1.`", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1.`"}], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1.`", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1.`"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1.`", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1.`"}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1.`", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", 
      RowBox[{"-", "1.`"}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "1.`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {32, 32}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 
       19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32}, {{1}, {2}, {
       3}, {4}, {5}, {6}, {7}, {8}, {9}, {10}, {11}, {12}, {13}, {14}, {15}, {
       16}, {17}, {18}, {19}, {20}, {21}, {22}, {23}, {24}, {25}, {26}, {
       27}, {28}, {29}, {30}, {31}, {32}}}, {-1., 1., -1., 1., -1., 1., -1., 
      1., -1., 1., -1., 1., -1., 1., -1., 1., -1., 1., -1., 1., -1., 1., -1., 
      1., -1., 1., -1., 1., -1., 1., -1., 1.}}]]]]], "Output",
 CellChangeTimes->{{3.821107972350261*^9, 3.8211079760854044`*^9}, {
  3.8211080070516357`*^9, 3.8211080240386066`*^9}},
 CellLabel->
  "Out[20]//MatrixForm=",ExpressionUUID->"e0c36521-38ea-407d-8894-\
97dc1ef23185"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["init"], "Input",
 CellChangeTimes->{{3.8211080434764166`*^9, 3.8211080440137005`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"2652949c-95b2-4479-bcbb-aa76782bcaaa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.821108044435562*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"91b2bad8-010b-4807-899c-27e567cc8228"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Sz", "[", 
   RowBox[{"[", "1", "]"}], "]"}], ".", "init"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sz", "[", 
   RowBox[{"[", "2", "]"}], "]"}], ".", "init"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sz", "[", 
   RowBox[{"[", "3", "]"}], "]"}], ".", "init"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sz", "[", 
   RowBox[{"[", "4", "]"}], "]"}], ".", "init"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sz", "[", 
   RowBox[{"[", "5", "]"}], "]"}], ".", "init"}]}], "Input",
 CellChangeTimes->{{3.82110807255777*^9, 3.8211080826895204`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"73d399fb-6116-4af3-9d25-1c8d778d5dc0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", 
   RowBox[{"-", "1.`"}], ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.821108083381899*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"f4edd426-87d2-43e6-b2dd-72ce5d001019"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "1.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{3.821108083385439*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"251e26e6-a0c8-44c0-be91-12b81dd2ce94"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", 
   RowBox[{"-", "1.`"}], ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8211080833888307`*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"da604545-2eb6-4db5-a572-ee6de16d9015"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", 
   RowBox[{"-", "1.`"}], ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.821108083393182*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"53c9aead-df26-4131-8961-45695493ff20"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "1.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{3.8211080833950586`*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"9fc86f2f-4c61-466a-abbe-50e23ad026f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Sz", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ".", "init"}], "\[Equal]", 
  RowBox[{
   RowBox[{"-", "1"}], "init"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sz", "[", 
    RowBox[{"[", "2", "]"}], "]"}], ".", "init"}], "\[Equal]", 
  RowBox[{"1", "init"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sz", "[", 
    RowBox[{"[", "3", "]"}], "]"}], ".", "init"}], "\[Equal]", 
  RowBox[{
   RowBox[{"-", "1"}], "init"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sz", "[", 
    RowBox[{"[", "4", "]"}], "]"}], ".", "init"}], "\[Equal]", 
  RowBox[{
   RowBox[{"-", "1"}], "init"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sz", "[", 
    RowBox[{"[", "5", "]"}], "]"}], ".", "init"}], "\[Equal]", 
  RowBox[{"1", "init"}]}]}], "Input",
 CellChangeTimes->{{3.8211080303148413`*^9, 3.821108054576592*^9}, {
  3.8211080922585974`*^9, 3.8211081203661633`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"8959cfab-0146-4109-9bc7-67fc51cab88d"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.821108034882573*^9, 3.8211080548322163`*^9}, 
   3.821108121019701*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"cb4e0a4d-ee71-4edc-96e5-a50c149ed061"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.821108034882573*^9, 3.8211080548322163`*^9}, 
   3.8211081210250163`*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"eee79657-d8c9-414f-8048-f788d319f9d7"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.821108034882573*^9, 3.8211080548322163`*^9}, 
   3.8211081210275254`*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"7a057501-f658-4c00-a4b6-4df99749aad7"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.821108034882573*^9, 3.8211080548322163`*^9}, 
   3.8211081210297794`*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"55e554aa-a1b3-4d8f-a5a3-56842f732407"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.821108034882573*^9, 3.8211080548322163`*^9}, 
   3.8211081210320673`*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"4eb9a7a4-4d67-4cf2-b52a-570385f8f7e8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ansatz (from TI\[CloseCurlyQuote]s Mathematica)", "Section",
 CellChangeTimes->{{3.813592150696907*^9, 3.813592153190167*^9}, {
  3.813593695621518*^9, 3.813593698460569*^9}, {3.813597371360907*^9, 
  3.813597373336154*^9}, {3.820687892364877*^9, 
  3.820687900302765*^9}},ExpressionUUID->"7f1537e8-521d-47b7-8b86-\
6032be0e685d"],

Cell["Initial state: ", "Text",
 CellChangeTimes->{{3.8206883018839197`*^9, 
  3.820688304787055*^9}},ExpressionUUID->"a996d5c7-90db-4333-8fbd-\
6472563b0ae8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"c", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "i"]}], "2"], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "L"}], "}"}]}], "]"}]}]], "Input",
 CellLabel->"In[13]:=",ExpressionUUID->"663bdcfb-7ffe-4057-9616-477249838e11"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1", ",", "0", ",", "1", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.8206938126865063`*^9, 3.820788259704938*^9, 
  3.8208601870199785`*^9, 3.82094710028784*^9, 3.821105849210577*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"ecfee3c2-36da-4374-9da7-125b9ed9c739"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"init", "=", 
  RowBox[{"UnitVector", "[", 
   RowBox[{
    SuperscriptBox["2", "L"], ",", 
    RowBox[{"FromDigits", "[", 
     RowBox[{"c", ",", "2"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.8206938168375654`*^9},
 Background->RGBColor[1, 1, 0.85],
 CellLabel->"In[14]:=",ExpressionUUID->"c7e1a9f2-dc29-43de-a9f5-47b377f13a69"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.8206938170978203`*^9, 3.820788260561143*^9, 
  3.8208601877839355`*^9, 3.8209471006668367`*^9, 3.8211058507194214`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"a6727bdd-2749-4c70-b289-4394a2287680"]
}, Open  ]],

Cell["Dept of the ansatz (P):", "Text",
 CellChangeTimes->{{3.820689520740735*^9, 3.820689530473588*^9}, {
  3.8209471018702555`*^9, 
  3.820947102494161*^9}},ExpressionUUID->"402f7af6-69a1-495f-8560-\
7eee936118be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalP]", "=", "2"}], ";"}]], "Input",
 CellChangeTimes->{{3.8206895329250298`*^9, 3.8206895494375525`*^9}},
 Background->RGBColor[1, 1, 0.85],
 CellLabel->"In[34]:=",ExpressionUUID->"ff4bce30-b864-4c0b-b75b-734f519b11f0"],

Cell[TextData[{
 "Construct vector \[CurlyPhi] = ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Theta]", 
      RowBox[{"1", ",", "1"}]], ",", 
     SubscriptBox["\[Phi]", 
      RowBox[{"1", ",", "2"}]], ",", 
     SubscriptBox["\[Theta]", 
      RowBox[{"1", ",", "3"}]], ",", "...", ",", 
     SubscriptBox["\[Phi]", 
      RowBox[{"\[ScriptCapitalP]", ",", "1"}]], ",", "..."}]}], 
   TraditionalForm]],ExpressionUUID->"efc550f5-eb3a-45fc-bc97-9c50d71256f2"],
 ")=(\[CurlyPhi][1],\[CurlyPhi][2],\[CurlyPhi][3],...,\[CurlyPhi][PL])"
}], "Text",
 CellChangeTimes->{{3.8206914661879606`*^9, 3.820691545987821*^9}, {
  3.820860853075364*^9, 
  3.820860869112484*^9}},ExpressionUUID->"c0e15427-38a9-4da9-a34b-\
440e1c9bf266"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vec\[CurlyPhi]", "[", 
     RowBox[{"Pdepth_", ",", "Lsite_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\[CurlyPhi]", "[", "j", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Pdepth", "*", "Lsite"}]}], "}"}]}], "]"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vec\[CurlyPhi]num", "[", 
    RowBox[{"Pdepth_", ",", "Lsite_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"2", "*", "Pi"}]}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Pdepth", "*", "Lsite"}]}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8206915503490324`*^9, 3.820691575467437*^9}, {
  3.820860626175956*^9, 3.820860673721834*^9}, {3.8208607639276533`*^9, 
  3.8208607972037697`*^9}, {3.82086083522209*^9, 3.8208608496734543`*^9}, {
  3.8208609090377445`*^9, 3.820860922218507*^9}, {3.8208629692521734`*^9, 
  3.8208629858427825`*^9}, {3.8211082902927027`*^9, 3.8211083354423914`*^9}},
 Background->GrayLevel[0.85],
 CellLabel->"In[95]:=",ExpressionUUID->"45ec5aad-bed9-4bbd-b6f9-6fce9f7c6ba0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CurlyPhi]ansatz", "=", 
  RowBox[{"vec\[CurlyPhi]", "[", 
   RowBox[{"\[ScriptCapitalP]", ",", "L"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.820862987853351*^9, 3.82086301407518*^9}, 
   3.8209471105627637`*^9},
 Background->RGBColor[1, 1, 0.85],
 CellLabel->"In[36]:=",ExpressionUUID->"129da94f-0e34-4bd7-9185-4cd39614d5f8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[CurlyPhi]", "[", "1", "]"}], ",", 
   RowBox[{"\[CurlyPhi]", "[", "2", "]"}], ",", 
   RowBox[{"\[CurlyPhi]", "[", "3", "]"}], ",", 
   RowBox[{"\[CurlyPhi]", "[", "4", "]"}], ",", 
   RowBox[{"\[CurlyPhi]", "[", "5", "]"}], ",", 
   RowBox[{"\[CurlyPhi]", "[", "6", "]"}], ",", 
   RowBox[{"\[CurlyPhi]", "[", "7", "]"}], ",", 
   RowBox[{"\[CurlyPhi]", "[", "8", "]"}], ",", 
   RowBox[{"\[CurlyPhi]", "[", "9", "]"}], ",", 
   RowBox[{"\[CurlyPhi]", "[", "10", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8209471108168507`*^9, 3.821108187819454*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"36e228b1-9bd2-42d9-b6b1-7e04c6c118cb"]
}, Open  ]],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["U", "even"], "(", 
    SubscriptBox["\[Phi]", "s"], ")"}], TraditionalForm]],ExpressionUUID->
  "08ef0edf-507d-47ba-9416-4b4bd60af44b"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["U", "odd"], "(", 
    SubscriptBox["\[Theta]", "s"], ")"}], TraditionalForm]],ExpressionUUID->
  "a1695aa9-b563-4ef2-b72b-20c214864675"],
 " for fixed s:"
}], "Text",
 CellChangeTimes->{{3.8206895601658897`*^9, 3.82068959441335*^9}, {
  3.8206913510560465`*^9, 
  3.820691353702923*^9}},ExpressionUUID->"669ab323-ac37-4d32-8bdc-\
3f7bab7a39db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"anglesvec", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Theta]", 
        RowBox[{"s", ",", "1"}]], ",", 
       SubscriptBox["\[Phi]", 
        RowBox[{"s", ",", "2"}]], ",", 
       SubscriptBox["\[Theta]", 
        RowBox[{"s", ",", "3"}]], ",", "..."}], ")"}], " ", "for", " ", "a", 
     " ", "fixed", " ", "s"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Us", "[", 
     RowBox[{"anglesvec_", ",", "Lsite_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[CurlyPhi]", ",", "n", ",", "Meven", ",", "Modd", ",", "j1", ",", 
        "j2"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"angvecs", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["\[Theta]", 
            RowBox[{"s", ",", "1"}]], ",", 
           SubscriptBox["\[Phi]", 
            RowBox[{"s", ",", "2"}]], ",", 
           SubscriptBox["\[Theta]", 
            RowBox[{"s", ",", "3"}]], ",", 
           SubscriptBox["\[Phi]", 
            RowBox[{"s", ",", "4"}]], ",", "..."}], "}"}], " ", "for", " ", 
         "fixed", " ", "s", " ", "constructed", " ", "outside", " ", "of", 
         " ", "this", " ", "function"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CurlyPhi]", "=", "anglesvec"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"n", "=", "Lsite"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "number", " ", "of", " ", "sites", " ", "of", " ", "the", " ", 
         "chain"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Meven", "=", 
        RowBox[{"IdentityMatrix", "[", 
         SuperscriptBox["2", "n"], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Modd", "=", 
        RowBox[{"IdentityMatrix", "[", 
         SuperscriptBox["2", "n"], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"j1", "=", "j"}], ";", "\[IndentingNewLine]", 
          RowBox[{"j2", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"j", "\[Equal]", "n"}], ",", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"j", "+", "1"}], ",", "n"}], "]"}], ",", 
             RowBox[{"j", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"EvenQ", "[", "j", "]"}], "\[Equal]", "True"}], ",", 
            RowBox[{"Meven", "=", 
             RowBox[{"Meven", ".", 
              RowBox[{"MatrixExp", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "I"}], ")"}], "*", 
                RowBox[{"\[CurlyPhi]", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "*", 
                RowBox[{"Heis", "[", 
                 RowBox[{"[", 
                  RowBox[{"j1", ",", "j2"}], "]"}], "]"}]}], "]"}]}]}], ",", 
            RowBox[{"Modd", "=", 
             RowBox[{"Modd", ".", 
              RowBox[{"MatrixExp", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "I"}], ")"}], "*", 
                RowBox[{"\[CurlyPhi]", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "*", 
                RowBox[{"Heis", "[", 
                 RowBox[{"[", 
                  RowBox[{"j1", ",", "j2"}], "]"}], "]"}]}], "]"}]}]}]}], 
           "]"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Meven", ",", "Modd"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQLTNxo3hy+RtHh4NVUiBa48djNRC9Le69BYjO602u
AdEvijbVg+iSsh09IDr/+bMJIHqZ2f25IHpHQtdBsPwMkYcg+kr0oY8g2vt1
0E8Q3fL03j8Q/WlPosB2IJ3zVU4URK8Sk1LZAaQFzlhrg+i2xYu9QPQF0etg
2mHRCaGHQDp4RqEciP5orK8NopddNgfTQq5XbUF01zFuJxBtc+N2MIien/kq
EkSLn5oXB6IvPVmaCKJFb1angtWl9aSBaMcqzQIQvUJKpBBEH3OSrwLRDNN8
O0F0T+XuCSC6Jdd8MohuChOeDaLv/VwzD0Rv+rNsMYgu3LwSTLdssFkBovek
2IPpGZ8+bwXR217J7QDRJyyr94Pdo9EEpgEfDNU1
  "],
 Background->GrayLevel[0.85],
 CellLabel->"In[48]:=",ExpressionUUID->"3b3b9462-ce50-4b91-8e12-fd2e4d3bd438"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "anglesvec", " ", "here", " ", "is", " ", "the", " ", "complete", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[Theta]", 
       RowBox[{"s", ",", "1"}]], ",", 
      SubscriptBox["\[Phi]", 
       RowBox[{"s", ",", "2"}]], ",", 
      SubscriptBox["\[Theta]", 
       RowBox[{"s", ",", "3"}]], ",", "...", ",", 
      SubscriptBox["\[Theta]", 
       RowBox[{"\[ScriptCapitalP]", ",", "1"}]], ",", 
      SubscriptBox["\[Phi]", 
       RowBox[{"\[ScriptCapitalP]", ",", "2"}]]}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"KLesser", "[", 
     RowBox[{"m_", ",", "anglesvec_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "M", ",", "\[CurlyPhi]tot", ",", "\[CurlyPhi]vecaux", ",", "Uevens", 
        ",", "Uodds"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"M", "=", 
        RowBox[{"IdentityMatrix", "[", 
         SuperscriptBox["2", "L"], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[CurlyPhi]tot", "=", "anglesvec"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"m", ">", "1"}], ",", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CurlyPhi]vecaux", "=", 
             RowBox[{"\[CurlyPhi]tot", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "L"}], ")"}], "+", 
                 "1"}], ";;", 
                RowBox[{"i", "*", "L"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Uevens", ",", "Uodds"}], "}"}], "=", 
             RowBox[{"Us", "[", 
              RowBox[{"\[CurlyPhi]vecaux", ",", "L"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"M", "=", 
             RowBox[{"M", ".", "Uevens", ".", "Uodds"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"m", "-", "1"}]}], "}"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "M"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KLarger", "[", 
     RowBox[{"m_", ",", "anglesvec_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "M", ",", "\[CurlyPhi]tot", ",", "\[CurlyPhi]vecaux", ",", "Uevens", 
        ",", "Uodds"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"M", "=", 
        RowBox[{"IdentityMatrix", "[", 
         SuperscriptBox["2", "L"], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[CurlyPhi]tot", "=", "anglesvec"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"m", "<", "\[ScriptCapitalP]"}], ",", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CurlyPhi]vecaux", "=", 
             RowBox[{"\[CurlyPhi]tot", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "L"}], ")"}], "+", 
                 "1"}], ";;", 
                RowBox[{"i", "*", "L"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Uevens", ",", "Uodds"}], "}"}], "=", 
             RowBox[{"Us", "[", 
              RowBox[{"\[CurlyPhi]vecaux", ",", "L"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"M", "=", 
             RowBox[{"M", ".", "Uevens", ".", "Uodds"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"m", "+", "1"}], ",", "\[ScriptCapitalP]"}], "}"}]}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", "M"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Multiplying", " ", "all", " ", "the", " ", 
     SubscriptBox["U", "even"], 
     SubscriptBox["U", "odd"], " ", 
     RowBox[{"(", 
      RowBox[{"needed", " ", "for", " ", "the", " ", "Ansatz"}], ")"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KProd", "[", "anglesvec_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "M", ",", "\[CurlyPhi]tot", ",", "\[CurlyPhi]vecaux", ",", "Uevens", 
        ",", "Uodds"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"M", "=", 
        RowBox[{"IdentityMatrix", "[", 
         SuperscriptBox["2", "L"], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[CurlyPhi]tot", "=", "anglesvec"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"\[CurlyPhi]vecaux", "=", 
           RowBox[{"\[CurlyPhi]tot", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"i", "-", "1"}], ")"}], "*", "L"}], ")"}], "+", 
               "1"}], ";;", 
              RowBox[{"i", "*", "L"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Uevens", ",", "Uodds"}], "}"}], "=", 
           RowBox[{"Us", "[", 
            RowBox[{"\[CurlyPhi]vecaux", ",", "L"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"M", "=", 
           RowBox[{"M", ".", "Uevens", ".", "Uodds"}]}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "\[ScriptCapitalP]"}], "}"}]}], "]"}], 
       ";", "\[IndentingNewLine]", "M"}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.820861051491942*^9, 3.8208610728896914`*^9}, {
   3.820861277136582*^9, 3.8208613158423758`*^9}, {3.8208613547645893`*^9, 
   3.8208614081215906`*^9}, 3.82086146834446*^9, {3.820861647886904*^9, 
   3.820861845801949*^9}, {3.82086197224485*^9, 3.820861974190631*^9}, {
   3.820862027858658*^9, 3.8208620506704645`*^9}, {3.820862132257674*^9, 
   3.8208621671501684`*^9}, {3.8208621972664804`*^9, 
   3.8208622418080997`*^9}, {3.8208623098486185`*^9, 3.820862444755176*^9}, {
   3.8208625726171894`*^9, 3.820862579703218*^9}, {3.8208626565075483`*^9, 
   3.820862665038703*^9}, {3.8208627402214255`*^9, 3.8208628202063556`*^9}, {
   3.8208628777769594`*^9, 3.8208628935657043`*^9}, {3.8208637378245006`*^9, 
   3.8208637463417225`*^9}, {3.820863798996914*^9, 3.8208637991385336`*^9}, {
   3.8209490198712006`*^9, 3.820949043344068*^9}},
 Background->GrayLevel[0.85],
 CellLabel->"In[49]:=",ExpressionUUID->"48939c7a-8801-4d2b-9b38-4a40b5da7913"],

Cell["States", "Text",
 CellChangeTimes->{{3.8208627020905423`*^9, 
  3.8208627035814934`*^9}},ExpressionUUID->"c2f9bcf3-c2dc-4eb9-8a27-\
3b6a29b1ffb5"],

Cell[TextData[{
 "A) Complete ansatz ",
 Cell[BoxData[
  FormBox[
   RowBox[{"|", 
    RowBox[{
     SubscriptBox["\[Psi]", "\[CurlyPhi]"], ">"}]}], TraditionalForm]],
  ExpressionUUID->"121a7e56-c855-4fbf-919d-90177394ef1a"]
}], "Text",
 CellChangeTimes->{{3.820862707611704*^9, 3.820862713338377*^9}, {
  3.820863111192551*^9, 
  3.82086312465557*^9}},ExpressionUUID->"3c4faf29-722b-4c40-bf42-\
77f08fb68326"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CurlyPhi]ansatznum", "=", 
  RowBox[{"vec\[CurlyPhi]num", "[", 
   RowBox[{"\[ScriptCapitalP]", ",", "L"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.821108268588292*^9, 3.821108272808297*^9}, {
  3.821108348467622*^9, 3.821108356329054*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"0405623c-df5f-40b8-8273-0b155fa6e143"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.20621544355033983`", ",", "2.6731192053693924`", ",", 
   "2.959739520562483`", ",", "3.236570916261199`", ",", "5.401461426915114`",
    ",", "4.796653140352902`", ",", "4.274049443190096`", ",", 
   "1.9071106110584228`", ",", "1.8422133861111298`", ",", 
   "5.714916163482206`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8211083571032133`*^9, {3.821112910148241*^9, 3.8211129266550016`*^9}},
 CellLabel->"Out[99]=",ExpressionUUID->"993e8cde-41bc-4978-a0f1-77e0a6549a19"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"\[Psi]", "=", 
    RowBox[{
     RowBox[{"KProd", "[", "\[CurlyPhi]ansatz", "]"}], ".", "init"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"\[Psi]", "=", 
   RowBox[{
    RowBox[{"KProd", "[", "\[CurlyPhi]ansatznum", "]"}], ".", 
    "init"}]}]}]], "Input",
 CellChangeTimes->{{3.8208629354645643`*^9, 3.8208629581727886`*^9}, {
  3.8208630210934057`*^9, 3.82086302486631*^9}, {3.8208630849298134`*^9, 
  3.8208630933722277`*^9}, {3.820949061176607*^9, 3.8209490653208055`*^9}, {
  3.821108375302082*^9, 3.821108398548169*^9}},
 Background->RGBColor[1, 1, 0.85],
 CellLabel->
  "In[100]:=",ExpressionUUID->"bd380713-8af7-4517-9258-81e4e7d294a6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.24195835360713142`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.16213120014880275`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.1992271793985724`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.6954169699748751`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.28599218138164206`"}], "+", 
    RowBox[{"0.05034606712445988`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.2556547127487187`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.2509770474959627`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.08349249607726186`"}], "-", 
    RowBox[{"0.11953702473049546`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.10252670201899365`"}], "-", 
    RowBox[{"0.051024340100143645`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.2781524430948557`"}], "-", 
    RowBox[{"0.021490657060425883`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.08138652245017258`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.12366039835037368`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.07729882641520468`"}], "-", 
    RowBox[{"0.19628719225850244`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.023912194038374225`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.0010837380250953606`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8211083769874983`*^9, 3.8211083846463413`*^9}, {
   3.821112887811228*^9, 3.821112895100981*^9}, 3.821112928265869*^9},
 CellLabel->
  "Out[100]=",ExpressionUUID->"14de4d84-9dc6-4aa6-aa4c-9c7e3e3f9d08"]
}, Open  ]],

Cell[TextData[{
 "B) ",
 Cell[BoxData[
  FormBox[
   RowBox[{"|", 
    RowBox[{
     SubscriptBox["\[Chi]", 
      SuperscriptBox["\[CurlyPhi]", 
       RowBox[{"(", "m", ")"}]]], ">"}]}], TraditionalForm]],ExpressionUUID->
  "342a494d-f574-459d-a543-5325e01fbd47"]
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.8208630732132072`*^9, 
  3.820863225308914*^9}},ExpressionUUID->"35ea4647-5e38-49a2-9404-\
53aafd4dd6f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Chi]state", "[", "m_", "]"}], ":=", 
     RowBox[{
      RowBox[{"KLarger", "[", 
       RowBox[{"m", ",", "\[CurlyPhi]ansatz"}], "]"}], ".", "init"}]}], ";"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Chi]state", "[", "m_", "]"}], ":=", 
    RowBox[{
     RowBox[{"KLarger", "[", 
      RowBox[{"m", ",", "\[CurlyPhi]ansatznum"}], "]"}], ".", "init"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.8208632308760204`*^9, 3.8208632408952165`*^9}, {
  3.8208633125824423`*^9, 3.8208633510854483`*^9}, {3.8211085930237284`*^9, 
  3.8211085981273785`*^9}},
 Background->GrayLevel[0.85],
 CellLabel->
  "In[101]:=",ExpressionUUID->"d3fc3727-71f4-4cc8-a873-ac6d233753c5"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", 
    RowBox[{"m", ",", "i"}]], TraditionalForm]],ExpressionUUID->
  "aa5af23b-e412-4afc-a078-446d1bc3a619"],
 " operator"
}], "Text",
 CellChangeTimes->{{3.8208634086206055`*^9, 
  3.820863426186577*^9}},ExpressionUUID->"055e5ba5-f195-4d33-8f99-\
6ab0cd92cb5f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"OpS", "[", 
      RowBox[{"m_", ",", "site_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "depthpos", ",", "jpos", ",", "\[CurlyPhi]aux", ",", "Ueven", ",", 
         "Uodd", ",", "Kop", ",", "j1", ",", "j2"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"depthpos", "=", "m"}], ";", "\[IndentingNewLine]", 
        RowBox[{"jpos", "=", "site"}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[CurlyPhi]aux", "=", 
         RowBox[{"\[CurlyPhi]ansatz", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"depthpos", "-", "1"}], ")"}], "*", "L"}], ")"}], "+",
              "1"}], ";;", 
            RowBox[{"depthpos", "*", "L"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Ueven", ",", "Uodd"}], "}"}], "=", 
         RowBox[{"Us", "[", 
          RowBox[{"\[CurlyPhi]aux", ",", "L"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"j1", "=", "jpos"}], ";", "\[IndentingNewLine]", 
        RowBox[{"j2", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"jpos", "\[Equal]", "L"}], ",", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"jpos", "+", "1"}], ",", "K"}], "]"}], ",", 
           RowBox[{"jpos", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"Kop", "=", 
         RowBox[{
          RowBox[{"KLesser", "[", 
           RowBox[{"depthpos", ",", "\[CurlyPhi]ansatz"}], "]"}], ".", 
          "Ueven", ".", 
          RowBox[{"Heis", "[", 
           RowBox[{"[", 
            RowBox[{"j1", ",", "j2"}], "]"}], "]"}], ".", "Uodd"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"OpS", "[", 
     RowBox[{"m_", ",", "site_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "depthpos", ",", "jpos", ",", "\[CurlyPhi]aux", ",", "Ueven", ",", 
        "Uodd", ",", "Kop", ",", "j1", ",", "j2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"depthpos", "=", "m"}], ";", "\[IndentingNewLine]", 
       RowBox[{"jpos", "=", "site"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[CurlyPhi]aux", "=", 
        RowBox[{"\[CurlyPhi]ansatznum", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"depthpos", "-", "1"}], ")"}], "*", "L"}], ")"}], "+", 
            "1"}], ";;", 
           RowBox[{"depthpos", "*", "L"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Ueven", ",", "Uodd"}], "}"}], "=", 
        RowBox[{"Us", "[", 
         RowBox[{"\[CurlyPhi]aux", ",", "L"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"j1", "=", "jpos"}], ";", "\[IndentingNewLine]", 
       RowBox[{"j2", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"jpos", "\[Equal]", "L"}], ",", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"jpos", "+", "1"}], ",", "L"}], "]"}], ",", 
          RowBox[{"jpos", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Kop", "=", 
        RowBox[{
         RowBox[{"KLesser", "[", 
          RowBox[{"depthpos", ",", "\[CurlyPhi]ansatznum"}], "]"}], ".", 
         "Ueven", ".", 
         RowBox[{"Heis", "[", 
          RowBox[{"[", 
           RowBox[{"j1", ",", "j2"}], "]"}], "]"}], ".", "Uodd"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.820863427750393*^9, 3.8208635699973197`*^9}, {
   3.8208636841979065`*^9, 3.820863753367934*^9}, {3.820863825295596*^9, 
   3.8208638922165203`*^9}, {3.820863932205557*^9, 3.82086402156168*^9}, {
   3.820949108117239*^9, 3.8209491589259243`*^9}, {3.821108623617565*^9, 
   3.821108648831835*^9}, 3.8211126355708294`*^9},
 Background->GrayLevel[0.85],
 CellLabel->
  "In[102]:=",ExpressionUUID->"38a13194-9301-457b-9019-d0f080f32369"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Quotient", "[", 
  RowBox[{"5", ",", "5"}], "]"}]], "Input",
 CellChangeTimes->{{3.8211108238022594`*^9, 3.8211108301764374`*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"99c10bbc-487a-41fa-9ae0-8ce7009315c8"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.8211108309363585`*^9},
 CellLabel->"Out[61]=",ExpressionUUID->"20831006-4b99-44ba-917c-85b65821fd67"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Convert", "[", 
   RowBox[{"j_", ",", "Lsite_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Totalsites", ",", "jinput", ",", "m", ",", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Totalsites", "=", "Lsite"}], ";", "\[IndentingNewLine]", 
     RowBox[{"jinput", "=", "j"}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"jinput", ",", "Totalsites"}], "]"}], "\[NotEqual]", "0"}], 
        ",", 
        RowBox[{
         RowBox[{"Quotient", "[", 
          RowBox[{"jinput", ",", "Totalsites"}], "]"}], "+", "1"}], ",", 
        RowBox[{"Quotient", "[", 
         RowBox[{"jinput", ",", "Totalsites"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"i", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"jinput", ",", "Totalsites"}], "]"}], "\[NotEqual]", "0"}], 
        ",", 
        RowBox[{"Mod", "[", 
         RowBox[{"jinput", ",", "Totalsites"}], "]"}], ",", "Totalsites"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"m", ",", "i"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8211104322410893`*^9, 3.8211106013971243`*^9}, {
  3.82111074805894*^9, 3.821110771181134*^9}, {3.8211108644929852`*^9, 
  3.8211109256131153`*^9}, {3.821110994822406*^9, 3.8211110723025494`*^9}},
 Background->GrayLevel[0.85],
 CellLabel->
  "In[103]:=",ExpressionUUID->"4a5fa77b-7e46-44ba-9222-56f6c5d76ad2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Convert", "[", 
  RowBox[{"9", ",", "L"}], "]"}]], "Input",
 CellChangeTimes->{{3.8211106506485553`*^9, 3.8211106510458713`*^9}, {
  3.821111088155764*^9, 3.8211111162144766`*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"1aea9730-5a1d-4e65-ab08-c3efe3f5be69"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{{3.8211111017564077`*^9, 3.8211111165610604`*^9}},
 CellLabel->"Out[66]=",ExpressionUUID->"ff0e422c-0014-4425-aa5e-a831026c2546"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["init"], "Input",
 CellChangeTimes->{{3.8208640575524063`*^9, 3.820864058078002*^9}, {
  3.8209491724632053`*^9, 3.8209491733813934`*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"ac493217-281c-45ec-956d-7fd651122030"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.8208640585337796`*^9, 3.8208644846719456`*^9, 
  3.820949174439323*^9, 3.8211086655995607`*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"65ab3b25-d6db-4c74-a498-5c25822dc65d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["\[CurlyPhi]ansatznum"], "Input",
 CellChangeTimes->{{3.82086406924514*^9, 3.8208640717364817`*^9}, {
  3.821108673160281*^9, 3.8211086735292044`*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"a15a4677-713e-43b9-8eda-abdcddd5bc83"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "3.691657404471485`", ",", "2.1406848536730525`", ",", "5.923647895807008`",
    ",", "1.999878837536821`", ",", "5.9718069128162785`", ",", 
   "4.961116069163012`", ",", "1.0036428345583506`", ",", 
   "2.220522546599481`", ",", "3.178287785379803`", ",", 
   "5.610842131350024`"}], "}"}]], "Output",
 CellChangeTimes->{3.820864072201236*^9, 3.8208644856593056`*^9, 
  3.820949175838968*^9, 3.82110867391327*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"a02113fd-d643-414c-9256-075bef9026da"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Amatrix", "[", "O_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dim", ",", "A", ",", "vecaux", ",", "ket", ",", "mdepth", ",", "sitei", 
      ",", "Smdag", ",", "Opm", ",", "ketm", ",", "bram", ",", "cm", ",", 
      "ndepth", ",", "sitej", ",", "Sndag", ",", "Opn", ",", "ketn", ",", 
      "bran", ",", "cn"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dim", "=", 
      RowBox[{"L", "*", "\[ScriptCapitalP]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ket", "=", 
      RowBox[{
       RowBox[{"KProd", "[", "\[CurlyPhi]ansatznum", "]"}], ".", "init"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mdepth", ",", "sitei"}], "}"}], "=", 
         RowBox[{"Convert", "[", 
          RowBox[{"i", ",", "L"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Smdag", "=", 
         RowBox[{"ConjugateTranspose", "[", 
          RowBox[{"OpS", "[", 
           RowBox[{"mdepth", ",", "sitei"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Opm", "=", 
         RowBox[{"Smdag", ".", "O"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ketm", "=", 
         RowBox[{
          RowBox[{"KLarger", "[", 
           RowBox[{"mdepth", ",", "\[CurlyPhi]ansatznum"}], "]"}], ".", 
          "init"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bram", "=", 
         RowBox[{"Conjugate", "[", "ketm", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"cm", "=", 
         RowBox[{"Im", "[", 
          RowBox[{"bram", ".", "Opm", ".", "ket"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vecaux", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"ndepth", ",", "sitej"}], "}"}], "=", 
            RowBox[{"Convert", "[", 
             RowBox[{"j", ",", "L"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Sndag", "=", 
            RowBox[{"ConjugateTranspose", "[", 
             RowBox[{"OpS", "[", 
              RowBox[{"ndepth", ",", "sitej"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Opn", "=", 
            RowBox[{"Sndag", ".", "O"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"ketn", "=", 
            RowBox[{
             RowBox[{"KLarger", "[", 
              RowBox[{"ndepth", ",", "\[CurlyPhi]ansatznum"}], "]"}], ".", 
             "init"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"bran", "=", 
            RowBox[{"Conjugate", "[", "ketn", "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"cn", "=", 
            RowBox[{"Im", "[", 
             RowBox[{"bran", ".", "Opn", ".", "ket"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"vecaux", ",", 
             RowBox[{"2", "*", "cm", "*", "cn"}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "dim"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"A", ",", "vecaux"}], "]"}], ";"}], "\[IndentingNewLine]", 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "dim"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "A"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.821108705972378*^9, 3.821108825503215*^9}, {
  3.821110373207943*^9, 3.8211104058900843`*^9}, {3.8211107144208837`*^9, 
  3.821110768589732*^9}, {3.821111132816701*^9, 3.821111198012149*^9}, {
  3.821111424767271*^9, 3.8211116095183396`*^9}, {3.8211116674249*^9, 
  3.8211119141853004`*^9}, {3.8211119516208634`*^9, 3.8211120402865286`*^9}, {
  3.821112435899165*^9, 3.8211124866495223`*^9}, {3.821112732234567*^9, 
  3.821112735249682*^9}},
 Background->GrayLevel[0.85],
 CellLabel->
  "In[104]:=",ExpressionUUID->"eac83125-0100-42f7-9af3-563bbe1a5602"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Ares", "=", 
   RowBox[{"Chop", "[", 
    RowBox[{"Amatrix", "[", 
     RowBox[{"Sz", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Ares", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"Det", "[", "Ares", "]"}]}], "Input",
 CellChangeTimes->{{3.8211120633767905`*^9, 3.821112068909384*^9}, {
  3.821112739106904*^9, 3.8211127738793*^9}, {3.8211129565024476`*^9, 
  3.8211129659031024`*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"8b2c7ef8-b563-469e-a426-1989408a6d08"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.7214808198162208`", "0", "0", "0", "0.3027535093353945`", 
      "0.5395431303260518`", "0.4644068827267744`", "0", 
      RowBox[{"-", "0.0901277708513421`"}], "0.6308721689782117`"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0.3027535093353945`", "0", "0", "0", "0.12704383110038162`", 
      "0.22640737169648567`", "0.1948781029838832`", "0", 
      RowBox[{"-", "0.037820130715007304`"}], "0.26473158794275053`"},
     {"0.5395431303260518`", "0", "0", "0", "0.22640737169648567`", 
      "0.4034851398491607`", "0.3472961946724978`", "0", 
      RowBox[{"-", "0.0674000171298094`"}], "0.47178349796297325`"},
     {"0.4644068827267744`", "0", "0", "0", "0.1948781029838832`", 
      "0.3472961946724978`", "0.2989320669382971`", "0", 
      RowBox[{"-", "0.05801395679353831`"}], "0.40608339036494395`"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "0.0901277708513421`"}], "0", "0", "0", 
      RowBox[{"-", "0.037820130715007304`"}], 
      RowBox[{"-", "0.0674000171298094`"}], 
      RowBox[{"-", "0.05801395679353831`"}], "0", "0.011258809458997354`", 
      RowBox[{"-", "0.07880888960657455`"}]},
     {"0.6308721689782117`", "0", "0", "0", "0.26473158794275053`", 
      "0.47178349796297325`", "0.40608339036494395`", "0", 
      RowBox[{"-", "0.07880888960657455`"}], "0.5516427916859298`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.821112082880234*^9, 3.821112507525363*^9, 3.821112698802035*^9, {
   3.8211127414771495`*^9, 3.8211127746870823`*^9}, {3.8211129489156833`*^9, 
   3.821112967826587*^9}},
 CellLabel->
  "Out[109]//MatrixForm=",ExpressionUUID->"70b106a0-b606-4884-8950-\
aa3f21ff865c"],

Cell[BoxData["0.`"], "Output",
 CellChangeTimes->{
  3.821112082880234*^9, 3.821112507525363*^9, 3.821112698802035*^9, {
   3.8211127414771495`*^9, 3.8211127746870823`*^9}, {3.8211129489156833`*^9, 
   3.8211129678301477`*^9}},
 CellLabel->
  "Out[110]=",ExpressionUUID->"6637abe6-3687-4858-9eea-f77440754a39"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1264, 661},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 217, 5, 96, "Title",ExpressionUUID->"42157d35-70ac-4fca-84ed-df6dcd0d8204"],
Cell[800, 29, 223, 5, 53, "Subtitle",ExpressionUUID->"7fe78ad0-52c0-4516-8f38-f54265dfcd27"],
Cell[CellGroupData[{
Cell[1048, 38, 246, 4, 67, "Section",ExpressionUUID->"bb7c3038-a6b7-4ffd-88af-268d2575ecdf"],
Cell[1297, 44, 202, 4, 28, "Input",ExpressionUUID->"f35adfce-c601-4ef0-9f73-f0ee369a01aa"],
Cell[1502, 50, 3667, 94, 352, "Input",ExpressionUUID->"14bb87d6-f6b4-46f3-a741-0236d3ea3d3c"],
Cell[5172, 146, 2484, 36, 44, "Input",ExpressionUUID->"7989c289-b53d-4f67-a91c-c5993f2c9b77"],
Cell[7659, 184, 8983, 217, 836, "Input",ExpressionUUID->"404676b0-d695-4efc-ae43-3ac5a6eee47c"],
Cell[CellGroupData[{
Cell[16667, 405, 211, 3, 28, "Input",ExpressionUUID->"97d2db22-b5d0-401c-818c-a8823edb1db1"],
Cell[16881, 410, 294, 5, 32, "Output",ExpressionUUID->"cfd86f1b-5566-414c-a3af-ccaca188233c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17212, 420, 213, 3, 28, "Input",ExpressionUUID->"dcc6669e-f919-469c-b239-b9a2dbba1480"],
Cell[17428, 425, 313, 5, 32, "Output",ExpressionUUID->"0ed1294d-24cc-4286-be92-03f5f1fdb584"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17778, 435, 314, 6, 28, "Input",ExpressionUUID->"25860629-5db5-4f12-a63c-ba0b4942c2b9"],
Cell[18095, 443, 7365, 131, 572, "Output",ExpressionUUID->"e0c36521-38ea-407d-8894-97dc1ef23185"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25497, 579, 179, 2, 28, "Input",ExpressionUUID->"2652949c-95b2-4479-bcbb-aa76782bcaaa"],
Cell[25679, 583, 513, 9, 32, "Output",ExpressionUUID->"91b2bad8-010b-4807-899c-27e567cc8228"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26229, 597, 677, 17, 105, "Input",ExpressionUUID->"73d399fb-6116-4af3-9d25-1c8d778d5dc0"],
Cell[26909, 616, 599, 11, 32, "Output",ExpressionUUID->"f4edd426-87d2-43e6-b2dd-72ce5d001019"],
Cell[27511, 629, 581, 10, 32, "Output",ExpressionUUID->"251e26e6-a0c8-44c0-be91-12b81dd2ce94"],
Cell[28095, 641, 601, 11, 32, "Output",ExpressionUUID->"da604545-2eb6-4db5-a572-ee6de16d9015"],
Cell[28699, 654, 599, 11, 32, "Output",ExpressionUUID->"53c9aead-df26-4131-8961-45695493ff20"],
Cell[29301, 667, 583, 10, 32, "Output",ExpressionUUID->"9fc86f2f-4c61-466a-abbe-50e23ad026f0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29921, 682, 1053, 31, 105, "Input",ExpressionUUID->"8959cfab-0146-4109-9bc7-67fc51cab88d"],
Cell[30977, 715, 204, 3, 32, "Output",ExpressionUUID->"cb4e0a4d-ee71-4edc-96e5-a50c149ed061"],
Cell[31184, 720, 206, 3, 32, "Output",ExpressionUUID->"eee79657-d8c9-414f-8048-f788d319f9d7"],
Cell[31393, 725, 206, 3, 32, "Output",ExpressionUUID->"7a057501-f658-4c00-a4b6-4df99749aad7"],
Cell[31602, 730, 206, 3, 32, "Output",ExpressionUUID->"55e554aa-a1b3-4d8f-a5a3-56842f732407"],
Cell[31811, 735, 206, 3, 32, "Output",ExpressionUUID->"4eb9a7a4-4d67-4cf2-b52a-570385f8f7e8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32066, 744, 336, 5, 67, "Section",ExpressionUUID->"7f1537e8-521d-47b7-8b86-6032be0e685d"],
Cell[32405, 751, 159, 3, 34, "Text",ExpressionUUID->"a996d5c7-90db-4333-8fbd-6472563b0ae8"],
Cell[CellGroupData[{
Cell[32589, 758, 364, 11, 49, "Input",ExpressionUUID->"663bdcfb-7ffe-4057-9616-477249838e11"],
Cell[32956, 771, 318, 5, 32, "Output",ExpressionUUID->"ecfee3c2-36da-4374-9da7-125b9ed9c739"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33311, 781, 362, 9, 48, "Input",ExpressionUUID->"c7e1a9f2-dc29-43de-a9f5-47b377f13a69"],
Cell[33676, 792, 612, 10, 32, "Output",ExpressionUUID->"a6727bdd-2749-4c70-b289-4394a2287680"]
}, Open  ]],
Cell[34303, 805, 216, 4, 34, "Text",ExpressionUUID->"402f7af6-69a1-495f-8560-7eee936118be"],
Cell[34522, 811, 267, 5, 44, "Input",ExpressionUUID->"ff4bce30-b864-4c0b-b75b-734f519b11f0"],
Cell[34792, 818, 757, 20, 36, "Text",ExpressionUUID->"c0e15427-38a9-4da9-a34b-440e1c9bf266"],
Cell[35552, 840, 1551, 39, 121, "Input",ExpressionUUID->"45ec5aad-bed9-4bbd-b6f9-6fce9f7c6ba0"],
Cell[CellGroupData[{
Cell[37128, 883, 353, 7, 44, "Input",ExpressionUUID->"129da94f-0e34-4bd7-9185-4cd39614d5f8"],
Cell[37484, 892, 689, 14, 32, "Output",ExpressionUUID->"36e228b1-9bd2-42d9-b6b1-7e04c6c118cb"]
}, Open  ]],
Cell[38188, 909, 619, 19, 34, "Text",ExpressionUUID->"669ab323-ac37-4d32-8bdc-3f7bab7a39db"],
Cell[38810, 930, 4374, 108, 296, "Input",ExpressionUUID->"3b3b9462-ce50-4b91-8e12-fd2e4d3bd438"],
Cell[43187, 1040, 7171, 176, 695, "Input",ExpressionUUID->"48939c7a-8801-4d2b-9b38-4a40b5da7913"],
Cell[50361, 1218, 152, 3, 34, "Text",ExpressionUUID->"c2f9bcf3-c2dc-4eb9-8a27-3b6a29b1ffb5"],
Cell[50516, 1223, 411, 12, 36, "Text",ExpressionUUID->"3c4faf29-722b-4c40-bf42-77f08fb68326"],
Cell[CellGroupData[{
Cell[50952, 1239, 346, 6, 28, "Input",ExpressionUUID->"0405623c-df5f-40b8-8273-0b155fa6e143"],
Cell[51301, 1247, 521, 10, 32, "Output",ExpressionUUID->"993e8cde-41bc-4978-a0f1-77e0a6549a19"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51859, 1262, 705, 17, 64, "Input",ExpressionUUID->"bd380713-8af7-4517-9258-81e4e7d294a6"],
Cell[52567, 1281, 3658, 75, 71, "Output",ExpressionUUID->"14de4d84-9dc6-4aa6-aa4c-9c7e3e3f9d08"]
}, Open  ]],
Cell[56240, 1359, 432, 14, 38, "Text",ExpressionUUID->"35ea4647-5e38-49a2-9404-53aafd4dd6f1",
 InitializationCell->True],
Cell[56675, 1375, 782, 22, 64, "Input",ExpressionUUID->"d3fc3727-71f4-4cc8-a873-ac6d233753c5"],
Cell[57460, 1399, 324, 10, 36, "Text",ExpressionUUID->"055e5ba5-f195-4d33-8f99-6ab0cd92cb5f"],
Cell[57787, 1411, 4353, 112, 387, "Input",ExpressionUUID->"38a13194-9301-457b-9019-d0f080f32369"],
Cell[CellGroupData[{
Cell[62165, 1527, 233, 4, 28, "Input",ExpressionUUID->"99c10bbc-487a-41fa-9ae0-8ce7009315c8"],
Cell[62401, 1533, 151, 2, 32, "Output",ExpressionUUID->"20831006-4b99-44ba-917c-85b65821fd67"]
}, Open  ]],
Cell[62567, 1538, 1671, 43, 159, "Input",ExpressionUUID->"4a5fa77b-7e46-44ba-9222-56f6c5d76ad2"],
Cell[CellGroupData[{
Cell[64263, 1585, 283, 5, 28, "Input",ExpressionUUID->"1aea9730-5a1d-4e65-ab08-c3efe3f5be69"],
Cell[64549, 1592, 222, 4, 32, "Output",ExpressionUUID->"ff0e422c-0014-4425-aa5e-a831026c2546"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64808, 1601, 230, 3, 28, "Input",ExpressionUUID->"ac493217-281c-45ec-956d-7fd651122030"],
Cell[65041, 1606, 588, 10, 32, "Output",ExpressionUUID->"65ab3b25-d6db-4c74-a498-5c25822dc65d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65666, 1621, 243, 3, 28, "Input",ExpressionUUID->"a15a4677-713e-43b9-8eda-abdcddd5bc83"],
Cell[65912, 1626, 536, 10, 32, "Output",ExpressionUUID->"a02113fd-d643-414c-9256-075bef9026da"]
}, Open  ]],
Cell[66463, 1639, 4364, 99, 577, "Input",ExpressionUUID->"eac83125-0100-42f7-9af3-563bbe1a5602"],
Cell[CellGroupData[{
Cell[70852, 1742, 576, 14, 67, "Input",ExpressionUUID->"8b2c7ef8-b563-469e-a426-1989408a6d08"],
Cell[71431, 1758, 2232, 45, 198, "Output",ExpressionUUID->"70b106a0-b606-4884-8950-aa3f21ff865c"],
Cell[73666, 1805, 310, 6, 32, "Output",ExpressionUUID->"6637abe6-3687-4858-9eea-f77440754a39"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

