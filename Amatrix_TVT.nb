(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     74551,       1917]
NotebookOptionsPosition[     68019,       1808]
NotebookOutlinePosition[     68431,       1824]
CellTagsIndexPosition[     68388,       1821]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Variational strategy for the time-evolution of a local observable\
\>", "Title",
 CellChangeTimes->{{3.82068728244985*^9, 
  3.8206873047440825`*^9}},ExpressionUUID->"42157d35-70ac-4fca-84ed-\
df6dcd0d8204"],

Cell["\<\
Calculating the matrix A  (see Notes_Thais/Local_op_variational.pdf)\
\>", "Subtitle",
 CellChangeTimes->{{3.8206874814421988`*^9, 
  3.82068754144462*^9}},ExpressionUUID->"7fe78ad0-52c0-4516-8f38-\
f54265dfcd27"],

Cell[CellGroupData[{

Cell["Functions (from TI\[CloseCurlyQuote]s Mathematica)", "Section",
 CellChangeTimes->{{3.820687818304344*^9, 3.820687849544361*^9}, {
  3.820687889580441*^9, 
  3.8206878896443048`*^9}},ExpressionUUID->"bb7c3038-a6b7-4ffd-88af-\
268d2575ecdf"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.765710166393487*^9, 3.765710180280023*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"f35adfce-c601-4ef0-9f73-f0ee369a01aa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FlipFlop", "[", 
   RowBox[{"n_", ",", "i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v", "=", 
      RowBox[{"IntegerDigits", "[", 
       RowBox[{"n", ",", "2", ",", "L"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "\[NotEqual]", "0"}], "&&", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "\[NotEqual]", "1"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "-", "1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "+", "1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"FromDigits", "[", 
        RowBox[{"v", ",", "2"}], "]"}]}], "\[IndentingNewLine]", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"-", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Raise", "[", 
   RowBox[{"n_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v", "=", 
      RowBox[{"IntegerDigits", "[", 
       RowBox[{"n", ",", "2", ",", "L"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"[", 
         RowBox[{"Mod", "[", 
          RowBox[{"i", ",", "L", ",", "1"}], "]"}], "]"}], "]"}], 
       "\[NotEqual]", "1"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "+", "1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"FromDigits", "[", 
        RowBox[{"v", ",", "2"}], "]"}]}], "\[IndentingNewLine]", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"-", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "[", 
   RowBox[{"t_", ",", "e_", ",", "v_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Transpose", "[", "v", "]"}], ".", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "e", " ", "t"}], "]"}], "]"}], ".", 
   RowBox[{"Conjugate", "[", "v", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.7655395073253803`*^9, 3.765539526822287*^9}, 
   3.7655404443969593`*^9, {3.765542375955605*^9, 3.765542395574185*^9}, {
   3.765542503282773*^9, 3.7655425108017397`*^9}, {3.7655427089217377`*^9, 
   3.765542717666914*^9}, {3.7655430607762747`*^9, 3.76554306089671*^9}, {
   3.76589530850611*^9, 3.765895308783208*^9}, {3.8135865636772413`*^9, 
   3.8135865642974653`*^9}, {3.813587206846246*^9, 3.813587230540331*^9}, {
   3.813592068652861*^9, 3.813592068830264*^9}, {3.813594393849374*^9, 
   3.813594397977915*^9}, {3.813594443293139*^9, 3.813594462812553*^9}, {
   3.816606089527637*^9, 3.816606096840437*^9}, {3.8166067889361267`*^9, 
   3.81660679307829*^9}, {3.816608819271003*^9, 3.816608822964926*^9}, {
   3.8166117140653152`*^9, 3.8166117200423937`*^9}, {3.816612035421781*^9, 
   3.8166120403160477`*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"14bb87d6-f6b4-46f3-a741-0236d3ea3d3c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"L", "=", "3"}], ";"}]], "Input",
 CellChangeTimes->{{3.765538817188937*^9, 3.765538820613866*^9}, {
   3.76553924686829*^9, 3.765539246946069*^9}, {3.765539292995078*^9, 
   3.7655392930589*^9}, {3.765539328444461*^9, 3.765539330208981*^9}, 
   3.765556581500142*^9, 3.76555666555637*^9, {3.765556808307291*^9, 
   3.7655568090371323`*^9}, 3.765564057088217*^9, {3.765710261306361*^9, 
   3.765710261454471*^9}, 3.76572838951164*^9, 3.765895319889732*^9, {
   3.765897875218302*^9, 3.765897875384502*^9}, 3.7659011870330677`*^9, 
   3.766315350352639*^9, 3.766327918955817*^9, 3.766404137569581*^9, {
   3.7664175746258545`*^9, 3.7664175747147245`*^9}, {3.766423389207467*^9, 
   3.766423389380169*^9}, 3.766510349459014*^9, {3.766512201302676*^9, 
   3.766512201546687*^9}, {3.7667631322787933`*^9, 3.7667631327675076`*^9}, {
   3.766763409034783*^9, 3.766763461133748*^9}, 3.766763937562231*^9, 
   3.7729881146509714`*^9, 3.77298885399009*^9, 3.773056211876685*^9, 
   3.773056787349367*^9, 3.7730569147126975`*^9, 3.779098747672633*^9, {
   3.779099582067582*^9, 3.77909958227472*^9}, 3.8135865402804003`*^9, 
   3.813587137997987*^9, 3.8135874154746304`*^9, 3.81359281566432*^9, {
   3.81359303312822*^9, 3.81359303324481*^9}, {3.8135932698872843`*^9, 
   3.813593282777891*^9}, 3.813593495159255*^9, {3.813594526949836*^9, 
   3.813594527610154*^9}, 3.8135946894678183`*^9, 3.813594774618676*^9, 
   3.813594934761162*^9, {3.813600032878961*^9, 3.813600032973908*^9}, 
   3.8136058563614492`*^9, {3.8136063439628468`*^9, 3.813606344072823*^9}, {
   3.813606499369738*^9, 3.813606516749812*^9}, {3.81360660978023*^9, 
   3.813606609872326*^9}, 3.813606763260933*^9, {3.814114559510291*^9, 
   3.814114559938724*^9}, 3.814115815308709*^9, {3.814560316272141*^9, 
   3.814560316382197*^9}, {3.8145608202744102`*^9, 3.814560820367893*^9}, 
   3.815911856233745*^9, 3.8159450474781218`*^9, {3.8166067104576187`*^9, 
   3.816606710543508*^9}, 3.8166068516891537`*^9, {3.816606891326357*^9, 
   3.816606930478354*^9}, {3.816608736817081*^9, 3.81660875968019*^9}, {
   3.816609271537735*^9, 3.816609271624645*^9}, 3.8166095850533743`*^9, {
   3.816610600279435*^9, 3.8166106003490953`*^9}, {3.816611821126563*^9, 
   3.8166118211691732`*^9}, {3.816619267429934*^9, 3.816619297050412*^9}, {
   3.816619366226264*^9, 3.816619371340807*^9}, {3.8213567142334704`*^9, 
   3.821356714895691*^9}},
 Background->RGBColor[1, 1, 0.85],
 CellLabel->
  "In[180]:=",ExpressionUUID->"7989c289-b53d-4f67-a91c-c5993f2c9b77"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Id", "=", 
   RowBox[{"IdentityMatrix", "[", 
    SuperscriptBox["2", "L"], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Heis", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SparseArray", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Flatten", "@", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"h", "=", 
                RowBox[{"FlipFlop", "[", 
                 RowBox[{"j", ",", "i", ",", "k"}], "]"}]}], ",", 
               RowBox[{"v", "=", 
                RowBox[{
                 RowBox[{"2", 
                  RowBox[{"IntegerDigits", "[", 
                   RowBox[{"j", ",", "2", ",", "L"}], "]"}]}], "-", "1"}]}]}],
               "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"h", "\[NotEqual]", 
                RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"j", "+", "1"}], ",", 
                    RowBox[{"h", "+", "1"}]}], "}"}], "\[Rule]", "2."}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"h", "+", "1"}], ",", 
                    RowBox[{"j", "+", "1"}]}], "}"}], "\[Rule]", "2."}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"j", "+", "1"}], ",", 
                    RowBox[{"j", "+", "1"}]}], "}"}], "->", 
                  RowBox[{"N", "[", 
                   RowBox[{
                    RowBox[{"v", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "*", 
                    RowBox[{"v", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"j", "+", "1"}], ",", 
                   RowBox[{"j", "+", "1"}]}], "}"}], "\[Rule]", 
                 RowBox[{"N", "[", 
                  RowBox[{
                   RowBox[{"v", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "*", 
                   RowBox[{"v", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}], "}"}]}], 
              "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "0", ",", 
             RowBox[{
              SuperscriptBox["2", "L"], "-", "1"}]}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["2", "L"], ",", 
          SuperscriptBox["2", "L"]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "L"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sz", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SparseArray", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"v", "=", 
               RowBox[{
                RowBox[{"2", 
                 RowBox[{"IntegerDigits", "[", 
                  RowBox[{"j", ",", "2", ",", "L"}], "]"}]}], "-", "1"}]}], 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"j", "+", "1"}]}], "}"}], "\[Rule]", 
              RowBox[{"N", "[", 
               RowBox[{"v", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "0", ",", 
             RowBox[{
              SuperscriptBox["2", "L"], "-", "1"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["2", "L"], ",", 
           SuperscriptBox["2", "L"]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "L"}], "}"}]}], "]"}], ",", "i"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SzTot", "=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Sz", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "L"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sp", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SparseArray", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Block", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"h", "=", 
                 RowBox[{"Raise", "[", 
                  RowBox[{"j", ",", "i"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"h", "\[NotEqual]", 
                  RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"h", "+", "1"}], ",", 
                    RowBox[{"j", "+", "1"}]}], "}"}], "\[Rule]", "1."}]}], 
                "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
             ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "0", ",", 
               RowBox[{
                SuperscriptBox["2", "L"], "-", "1"}]}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", ",", "Null"}], "]"}], "\[IndentingNewLine]",
          ",", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["2", "L"], ",", 
           SuperscriptBox["2", "L"]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "L"}], "}"}]}], "]"}], ",", "i"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sm", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"Sp", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "L"}], "}"}]}], "]"}], ",", "i"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.76554026306886*^9, 3.7655402751049557`*^9}, {
   3.765540362866849*^9, 3.765540393945359*^9}, {3.765540547718257*^9, 
   3.765540593855013*^9}, {3.7655409690298233`*^9, 3.765541135888237*^9}, {
   3.765541181923973*^9, 3.765541190612671*^9}, {3.765541264839321*^9, 
   3.765541276424123*^9}, {3.765541331048069*^9, 3.7655413377084827`*^9}, {
   3.7655536076374283`*^9, 3.7655536616720343`*^9}, {3.765553764433598*^9, 
   3.765553821171158*^9}, {3.765553874406219*^9, 3.765553886076502*^9}, {
   3.765553926359667*^9, 3.765553930654847*^9}, 3.765553963517459*^9, {
   3.765634470309163*^9, 3.765634549159091*^9}, {3.765634597923142*^9, 
   3.765634599008275*^9}, {3.765634670828383*^9, 3.76563485202665*^9}, {
   3.765895294067505*^9, 3.7658952972454157`*^9}, {3.7658966428426237`*^9, 
   3.76589665054349*^9}, {3.7664027896553326`*^9, 3.766402842838036*^9}, {
   3.7664030062286606`*^9, 3.7664030102797575`*^9}, {3.7664030709648066`*^9, 
   3.766403072531369*^9}, {3.772988891434066*^9, 3.7729888929400015`*^9}, {
   3.773056129141179*^9, 3.7730561367692347`*^9}, {3.779099056554234*^9, 
   3.779099058837243*^9}, {3.8135865796964083`*^9, 3.813586589985237*^9}, {
   3.813586948658258*^9, 3.813586990902678*^9}, 3.813587037734062*^9, {
   3.813587240397996*^9, 3.813587240603529*^9}, {3.813587389219864*^9, 
   3.813587390529579*^9}, {3.8135874366201067`*^9, 3.813587437616737*^9}, {
   3.813591938072456*^9, 3.813591953214341*^9}, {3.813594476328452*^9, 
   3.8135945138364477`*^9}, 3.8135946176305647`*^9, 3.81359473937271*^9, {
   3.81359477913941*^9, 3.813594779232057*^9}, {3.813594996602191*^9, 
   3.813594997726571*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"404676b0-d695-4efc-ae43-3ac5a6eee47c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "Id", "]"}]], "Input",
 CellChangeTimes->{{3.8206935228779964`*^9, 3.820693526963817*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"97d2db22-b5d0-401c-818c-a8823edb1db1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8", ",", "8"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8206935276118965`*^9, 3.8207882542056313`*^9, 3.82086018275239*^9, 
   3.8209470985664816`*^9, 3.8211058458008356`*^9, {3.8213566975487375`*^9, 
   3.821356718082053*^9}, 3.8213587372801323`*^9, 3.8213611508793135`*^9},
 CellLabel->
  "Out[187]=",ExpressionUUID->"e27c3960-c48d-4ba3-a2f1-6e24e1db48e8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "Heis", "]"}]], "Input",
 CellChangeTimes->{{3.8206935287869444`*^9, 3.820693531419685*^9}},
 CellLabel->
  "In[188]:=",ExpressionUUID->"dcc6669e-f919-469c-b239-b9a2dbba1480"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "3", ",", "8", ",", "8"}], "}"}]], "Output",
 CellChangeTimes->{
  3.820693532157711*^9, 3.8207882550609803`*^9, 3.820860183347799*^9, 
   3.8209470990310955`*^9, 3.8211058466266055`*^9, {3.821356697595698*^9, 
   3.821356718108182*^9}, 3.821358737290908*^9, 3.8213611509130073`*^9},
 CellLabel->
  "Out[188]=",ExpressionUUID->"a29f0d01-3c7a-4cc3-b338-295551c67fac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["init"], "Input",
 CellChangeTimes->{{3.8211080434764166`*^9, 3.8211080440137005`*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"2652949c-95b2-4479-bcbb-aa76782bcaaa"],

Cell[BoxData["init"], "Output",
 CellChangeTimes->{
  3.821108044435562*^9, {3.821356697700591*^9, 3.821356718353734*^9}, 
   3.821358737326166*^9, 3.821361150947341*^9},
 CellLabel->
  "Out[189]=",ExpressionUUID->"0891d354-7ddc-48cf-b721-c4e2bbc53d52"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ansatz (from TI\[CloseCurlyQuote]s Mathematica)", "Section",
 CellChangeTimes->{{3.813592150696907*^9, 3.813592153190167*^9}, {
  3.813593695621518*^9, 3.813593698460569*^9}, {3.813597371360907*^9, 
  3.813597373336154*^9}, {3.820687892364877*^9, 
  3.820687900302765*^9}},ExpressionUUID->"7f1537e8-521d-47b7-8b86-\
6032be0e685d"],

Cell["Initial state: ", "Text",
 CellChangeTimes->{{3.8206883018839197`*^9, 
  3.820688304787055*^9}},ExpressionUUID->"a996d5c7-90db-4333-8fbd-\
6472563b0ae8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"c", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "i"]}], "2"], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "L"}], "}"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[190]:=",ExpressionUUID->"663bdcfb-7ffe-4057-9616-477249838e11"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8206938126865063`*^9, 3.820788259704938*^9, 3.8208601870199785`*^9, 
   3.82094710028784*^9, 3.821105849210577*^9, {3.821356698672466*^9, 
   3.8213567189274487`*^9}, 3.821358737335408*^9, 3.821361150984061*^9},
 CellLabel->
  "Out[190]=",ExpressionUUID->"1cbeb9fe-c247-4091-baaa-0f8fc5277543"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"init", "=", 
  RowBox[{"UnitVector", "[", 
   RowBox[{
    SuperscriptBox["2", "L"], ",", 
    RowBox[{"FromDigits", "[", 
     RowBox[{"c", ",", "2"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.8206938168375654`*^9},
 Background->RGBColor[1, 1, 0.85],
 CellLabel->
  "In[191]:=",ExpressionUUID->"c7e1a9f2-dc29-43de-a9f5-47b377f13a69"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.8206938170978203`*^9, 3.820788260561143*^9, 3.8208601877839355`*^9, 
   3.8209471006668367`*^9, 3.8211058507194214`*^9, {3.8213566987223325`*^9, 
   3.821356718973998*^9}, 3.821358737373018*^9, 3.82136115102279*^9},
 CellLabel->
  "Out[191]=",ExpressionUUID->"0cc90413-e3f7-4e6c-802e-5e5e243d70e5"]
}, Open  ]],

Cell["Dept of the ansatz (P):", "Text",
 CellChangeTimes->{{3.820689520740735*^9, 3.820689530473588*^9}, {
  3.8209471018702555`*^9, 
  3.820947102494161*^9}},ExpressionUUID->"402f7af6-69a1-495f-8560-\
7eee936118be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalP]", "=", "2"}], ";"}]], "Input",
 CellChangeTimes->{{3.8206895329250298`*^9, 3.8206895494375525`*^9}, {
   3.8213566877752333`*^9, 3.8213566878941483`*^9}, 3.8213587333983765`*^9},
 Background->RGBColor[1, 1, 0.85],
 CellLabel->
  "In[192]:=",ExpressionUUID->"ff4bce30-b864-4c0b-b75b-734f519b11f0"],

Cell[TextData[{
 "Construct vector \[CurlyPhi] = ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Theta]", 
      RowBox[{"1", ",", "1"}]], ",", 
     SubscriptBox["\[Phi]", 
      RowBox[{"1", ",", "2"}]], ",", 
     SubscriptBox["\[Theta]", 
      RowBox[{"1", ",", "3"}]], ",", "...", ",", 
     SubscriptBox["\[Phi]", 
      RowBox[{"\[ScriptCapitalP]", ",", "1"}]], ",", "..."}]}], 
   TraditionalForm]],ExpressionUUID->"efc550f5-eb3a-45fc-bc97-9c50d71256f2"],
 ")=(\[CurlyPhi][1],\[CurlyPhi][2],\[CurlyPhi][3],...,\[CurlyPhi][PL])"
}], "Text",
 CellChangeTimes->{{3.8206914661879606`*^9, 3.820691545987821*^9}, {
  3.820860853075364*^9, 
  3.820860869112484*^9}},ExpressionUUID->"c0e15427-38a9-4da9-a34b-\
440e1c9bf266"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vec\[CurlyPhi]", "[", 
     RowBox[{"Pdepth_", ",", "Lsite_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\[CurlyPhi]", "[", "j", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Pdepth", "*", "Lsite"}]}], "}"}]}], "]"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vec\[CurlyPhi]num", "[", 
    RowBox[{"Pdepth_", ",", "Lsite_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"2", "*", "Pi"}]}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Pdepth", "*", "Lsite"}]}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8206915503490324`*^9, 3.820691575467437*^9}, {
  3.820860626175956*^9, 3.820860673721834*^9}, {3.8208607639276533`*^9, 
  3.8208607972037697`*^9}, {3.82086083522209*^9, 3.8208608496734543`*^9}, {
  3.8208609090377445`*^9, 3.820860922218507*^9}, {3.8208629692521734`*^9, 
  3.8208629858427825`*^9}, {3.8211082902927027`*^9, 3.8211083354423914`*^9}},
 Background->GrayLevel[0.85],
 CellLabel->
  "In[193]:=",ExpressionUUID->"45ec5aad-bed9-4bbd-b6f9-6fce9f7c6ba0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CurlyPhi]ansatz", "=", 
  RowBox[{"vec\[CurlyPhi]", "[", 
   RowBox[{"\[ScriptCapitalP]", ",", "L"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.820862987853351*^9, 3.82086301407518*^9}, 
   3.8209471105627637`*^9},
 Background->RGBColor[1, 1, 0.85],
 CellLabel->
  "In[195]:=",ExpressionUUID->"129da94f-0e34-4bd7-9185-4cd39614d5f8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[CurlyPhi]", "[", "1", "]"}], ",", 
   RowBox[{"\[CurlyPhi]", "[", "2", "]"}], ",", 
   RowBox[{"\[CurlyPhi]", "[", "3", "]"}], ",", 
   RowBox[{"\[CurlyPhi]", "[", "4", "]"}], ",", 
   RowBox[{"\[CurlyPhi]", "[", "5", "]"}], ",", 
   RowBox[{"\[CurlyPhi]", "[", "6", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8209471108168507`*^9, 3.821108187819454*^9, {3.821356698810097*^9, 
   3.8213567190368147`*^9}, 3.821358737430329*^9, 3.8213611510812035`*^9},
 CellLabel->
  "Out[195]=",ExpressionUUID->"ea9caca9-5abc-4aee-8bd4-a41eb117c4fb"]
}, Open  ]],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["U", "even"], "(", 
    SubscriptBox["\[Phi]", "s"], ")"}], TraditionalForm]],ExpressionUUID->
  "08ef0edf-507d-47ba-9416-4b4bd60af44b"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["U", "odd"], "(", 
    SubscriptBox["\[Theta]", "s"], ")"}], TraditionalForm]],ExpressionUUID->
  "a1695aa9-b563-4ef2-b72b-20c214864675"],
 " for fixed s:"
}], "Text",
 CellChangeTimes->{{3.8206895601658897`*^9, 3.82068959441335*^9}, {
  3.8206913510560465`*^9, 
  3.820691353702923*^9}},ExpressionUUID->"669ab323-ac37-4d32-8bdc-\
3f7bab7a39db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"anglesvec", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Theta]", 
        RowBox[{"s", ",", "1"}]], ",", 
       SubscriptBox["\[Phi]", 
        RowBox[{"s", ",", "2"}]], ",", 
       SubscriptBox["\[Theta]", 
        RowBox[{"s", ",", "3"}]], ",", "..."}], ")"}], " ", "for", " ", "a", 
     " ", "fixed", " ", "s"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Us", "[", 
     RowBox[{"anglesvec_", ",", "Lsite_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[CurlyPhi]", ",", "n", ",", "Meven", ",", "Modd", ",", "j1", ",", 
        "j2"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"angvecs", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["\[Theta]", 
            RowBox[{"s", ",", "1"}]], ",", 
           SubscriptBox["\[Phi]", 
            RowBox[{"s", ",", "2"}]], ",", 
           SubscriptBox["\[Theta]", 
            RowBox[{"s", ",", "3"}]], ",", 
           SubscriptBox["\[Phi]", 
            RowBox[{"s", ",", "4"}]], ",", "..."}], "}"}], " ", "for", " ", 
         "fixed", " ", "s", " ", "constructed", " ", "outside", " ", "of", 
         " ", "this", " ", "function"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CurlyPhi]", "=", "anglesvec"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"n", "=", "Lsite"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "number", " ", "of", " ", "sites", " ", "of", " ", "the", " ", 
         "chain"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Meven", "=", 
        RowBox[{"IdentityMatrix", "[", 
         SuperscriptBox["2", "n"], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Modd", "=", 
        RowBox[{"IdentityMatrix", "[", 
         SuperscriptBox["2", "n"], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"j1", "=", "j"}], ";", "\[IndentingNewLine]", 
          RowBox[{"j2", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"j", "\[Equal]", "n"}], ",", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"j", "+", "1"}], ",", "n"}], "]"}], ",", 
             RowBox[{"j", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"EvenQ", "[", "j", "]"}], "\[Equal]", "True"}], ",", 
            RowBox[{"Meven", "=", 
             RowBox[{"Meven", ".", 
              RowBox[{"MatrixExp", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "I"}], ")"}], "*", 
                RowBox[{"\[CurlyPhi]", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "*", 
                RowBox[{"Heis", "[", 
                 RowBox[{"[", 
                  RowBox[{"j1", ",", "j2"}], "]"}], "]"}]}], "]"}]}]}], ",", 
            RowBox[{"Modd", "=", 
             RowBox[{"Modd", ".", 
              RowBox[{"MatrixExp", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "I"}], ")"}], "*", 
                RowBox[{"\[CurlyPhi]", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "*", 
                RowBox[{"Heis", "[", 
                 RowBox[{"[", 
                  RowBox[{"j1", ",", "j2"}], "]"}], "]"}]}], "]"}]}]}]}], 
           "]"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Meven", ",", "Modd"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQLTNxo3hy+RtHh4NVUiBa48djNRC9Le69BYjO602u
AdEvijbVg+iSsh09IDr/+bMJIHqZ2f25IHpHQtdBsPwMkYcg+kr0oY8g2vt1
0E8Q3fL03j8Q/WlPosB2IJ3zVU4URK8Sk1LZAaQFzlhrg+i2xYu9QPQF0etg
2mHRCaGHQDp4RqEciP5orK8NopddNgfTQq5XbUF01zFuJxBtc+N2MIien/kq
EkSLn5oXB6IvPVmaCKJFb1angtWl9aSBaMcqzQIQvUJKpBBEH3OSrwLRDNN8
O0F0T+XuCSC6Jdd8MohuChOeDaLv/VwzD0Rv+rNsMYgu3LwSTLdssFkBovek
2IPpGZ8+bwXR217J7QDRJyyr94Pdo9EEpgEfDNU1
  "],
 Background->GrayLevel[0.85],
 CellLabel->
  "In[196]:=",ExpressionUUID->"3b3b9462-ce50-4b91-8e12-fd2e4d3bd438"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "anglesvec", " ", "here", " ", "is", " ", "the", " ", "complete", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[Theta]", 
       RowBox[{"s", ",", "1"}]], ",", 
      SubscriptBox["\[Phi]", 
       RowBox[{"s", ",", "2"}]], ",", 
      SubscriptBox["\[Theta]", 
       RowBox[{"s", ",", "3"}]], ",", "...", ",", 
      SubscriptBox["\[Theta]", 
       RowBox[{"\[ScriptCapitalP]", ",", "1"}]], ",", 
      SubscriptBox["\[Phi]", 
       RowBox[{"\[ScriptCapitalP]", ",", "2"}]]}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"KLesser", "[", 
     RowBox[{"m_", ",", "anglesvec_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "M", ",", "\[CurlyPhi]tot", ",", "\[CurlyPhi]vecaux", ",", "Uevens", 
        ",", "Uodds"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"M", "=", 
        RowBox[{"IdentityMatrix", "[", 
         SuperscriptBox["2", "L"], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[CurlyPhi]tot", "=", "anglesvec"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"m", ">", "1"}], ",", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CurlyPhi]vecaux", "=", 
             RowBox[{"\[CurlyPhi]tot", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "L"}], ")"}], "+", 
                 "1"}], ";;", 
                RowBox[{"i", "*", "L"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Uevens", ",", "Uodds"}], "}"}], "=", 
             RowBox[{"Us", "[", 
              RowBox[{"\[CurlyPhi]vecaux", ",", "L"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"M", "=", 
             RowBox[{"M", ".", "Uevens", ".", "Uodds"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"m", "-", "1"}]}], "}"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "M"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KLarger", "[", 
     RowBox[{"m_", ",", "anglesvec_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "M", ",", "\[CurlyPhi]tot", ",", "\[CurlyPhi]vecaux", ",", "Uevens", 
        ",", "Uodds"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"M", "=", 
        RowBox[{"IdentityMatrix", "[", 
         SuperscriptBox["2", "L"], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[CurlyPhi]tot", "=", "anglesvec"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"m", "<", "\[ScriptCapitalP]"}], ",", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CurlyPhi]vecaux", "=", 
             RowBox[{"\[CurlyPhi]tot", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "L"}], ")"}], "+", 
                 "1"}], ";;", 
                RowBox[{"i", "*", "L"}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Uevens", ",", "Uodds"}], "}"}], "=", 
             RowBox[{"Us", "[", 
              RowBox[{"\[CurlyPhi]vecaux", ",", "L"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"M", "=", 
             RowBox[{"M", ".", "Uevens", ".", "Uodds"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"m", "+", "1"}], ",", "\[ScriptCapitalP]"}], "}"}]}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", "M"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Multiplying", " ", "all", " ", "the", " ", 
     SubscriptBox["U", "even"], 
     SubscriptBox["U", "odd"], " ", 
     RowBox[{"(", 
      RowBox[{"needed", " ", "for", " ", "the", " ", "Ansatz"}], ")"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KProd", "[", "anglesvec_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "M", ",", "\[CurlyPhi]tot", ",", "\[CurlyPhi]vecaux", ",", "Uevens", 
        ",", "Uodds"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"M", "=", 
        RowBox[{"IdentityMatrix", "[", 
         SuperscriptBox["2", "L"], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[CurlyPhi]tot", "=", "anglesvec"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"\[CurlyPhi]vecaux", "=", 
           RowBox[{"\[CurlyPhi]tot", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"i", "-", "1"}], ")"}], "*", "L"}], ")"}], "+", 
               "1"}], ";;", 
              RowBox[{"i", "*", "L"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Uevens", ",", "Uodds"}], "}"}], "=", 
           RowBox[{"Us", "[", 
            RowBox[{"\[CurlyPhi]vecaux", ",", "L"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"M", "=", 
           RowBox[{"M", ".", "Uevens", ".", "Uodds"}]}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "\[ScriptCapitalP]"}], "}"}]}], "]"}], 
       ";", "\[IndentingNewLine]", "M"}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.820861051491942*^9, 3.8208610728896914`*^9}, {
   3.820861277136582*^9, 3.8208613158423758`*^9}, {3.8208613547645893`*^9, 
   3.8208614081215906`*^9}, 3.82086146834446*^9, {3.820861647886904*^9, 
   3.820861845801949*^9}, {3.82086197224485*^9, 3.820861974190631*^9}, {
   3.820862027858658*^9, 3.8208620506704645`*^9}, {3.820862132257674*^9, 
   3.8208621671501684`*^9}, {3.8208621972664804`*^9, 
   3.8208622418080997`*^9}, {3.8208623098486185`*^9, 3.820862444755176*^9}, {
   3.8208625726171894`*^9, 3.820862579703218*^9}, {3.8208626565075483`*^9, 
   3.820862665038703*^9}, {3.8208627402214255`*^9, 3.8208628202063556`*^9}, {
   3.8208628777769594`*^9, 3.8208628935657043`*^9}, {3.8208637378245006`*^9, 
   3.8208637463417225`*^9}, {3.820863798996914*^9, 3.8208637991385336`*^9}, {
   3.8209490198712006`*^9, 3.820949043344068*^9}},
 Background->GrayLevel[0.85],
 CellLabel->
  "In[197]:=",ExpressionUUID->"48939c7a-8801-4d2b-9b38-4a40b5da7913"],

Cell["States", "Text",
 CellChangeTimes->{{3.8208627020905423`*^9, 
  3.8208627035814934`*^9}},ExpressionUUID->"c2f9bcf3-c2dc-4eb9-8a27-\
3b6a29b1ffb5"],

Cell[TextData[{
 "A) Complete ansatz ",
 Cell[BoxData[
  FormBox[
   RowBox[{"|", 
    RowBox[{
     SubscriptBox["\[Psi]", "\[CurlyPhi]"], ">"}]}], TraditionalForm]],
  ExpressionUUID->"121a7e56-c855-4fbf-919d-90177394ef1a"]
}], "Text",
 CellChangeTimes->{{3.820862707611704*^9, 3.820862713338377*^9}, {
  3.820863111192551*^9, 
  3.82086312465557*^9}},ExpressionUUID->"3c4faf29-722b-4c40-bf42-\
77f08fb68326"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CurlyPhi]ansatznum", "=", 
  RowBox[{"vec\[CurlyPhi]num", "[", 
   RowBox[{"\[ScriptCapitalP]", ",", "L"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.821108268588292*^9, 3.821108272808297*^9}, {
  3.821108348467622*^9, 3.821108356329054*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"0405623c-df5f-40b8-8273-0b155fa6e143"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.16910091746246536`", ",", "0.9448821759321522`", ",", 
   "2.8618332925668106`", ",", "2.046109416523233`", ",", 
   "0.4777588309790408`", ",", "5.004223802728816`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8211083571032133`*^9, {3.821112910148241*^9, 3.8211129266550016`*^9}, {
   3.821356698870941*^9, 3.8213567190980797`*^9}, 3.8213587374945126`*^9, 
   3.82136115115737*^9},
 CellLabel->
  "Out[200]=",ExpressionUUID->"e3ec365e-ffd5-47aa-b66e-f9d32b91911d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"\[Psi]", "=", 
    RowBox[{
     RowBox[{"KProd", "[", "\[CurlyPhi]ansatz", "]"}], ".", "init"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"\[Psi]", "=", 
   RowBox[{
    RowBox[{"KProd", "[", "\[CurlyPhi]ansatznum", "]"}], ".", 
    "init"}]}]}]], "Input",
 CellChangeTimes->{{3.8208629354645643`*^9, 3.8208629581727886`*^9}, {
  3.8208630210934057`*^9, 3.82086302486631*^9}, {3.8208630849298134`*^9, 
  3.8208630933722277`*^9}, {3.820949061176607*^9, 3.8209490653208055`*^9}, {
  3.821108375302082*^9, 3.821108398548169*^9}},
 Background->RGBColor[1, 1, 0.85],
 CellLabel->
  "In[201]:=",ExpressionUUID->"bd380713-8af7-4517-9258-81e4e7d294a6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.10633358817047618`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.8655248142826649`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.09086685839031236`"}], "+", 
    RowBox[{"0.07179759115010648`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.47125597777930267`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.06376587838601996`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8211083769874983`*^9, 3.8211083846463413`*^9}, {
   3.821112887811228*^9, 3.821112895100981*^9}, 3.821112928265869*^9, {
   3.821356698925787*^9, 3.821356719138969*^9}, 3.8213587375304146`*^9, 
   3.821361151208191*^9},
 CellLabel->
  "Out[201]=",ExpressionUUID->"07e20def-8d54-483a-9001-cbfe92147c61"]
}, Open  ]],

Cell[TextData[{
 "B) ",
 Cell[BoxData[
  FormBox[
   RowBox[{"|", 
    RowBox[{
     SubscriptBox["\[Chi]", 
      SuperscriptBox["\[CurlyPhi]", 
       RowBox[{"(", "m", ")"}]]], ">"}]}], TraditionalForm]],ExpressionUUID->
  "342a494d-f574-459d-a543-5325e01fbd47"]
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.8208630732132072`*^9, 
  3.820863225308914*^9}},ExpressionUUID->"35ea4647-5e38-49a2-9404-\
53aafd4dd6f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Chi]state", "[", "m_", "]"}], ":=", 
     RowBox[{
      RowBox[{"KLarger", "[", 
       RowBox[{"m", ",", "\[CurlyPhi]ansatz"}], "]"}], ".", "init"}]}], ";"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Chi]state", "[", "m_", "]"}], ":=", 
    RowBox[{
     RowBox[{"KLarger", "[", 
      RowBox[{"m", ",", "\[CurlyPhi]ansatznum"}], "]"}], ".", "init"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.8208632308760204`*^9, 3.8208632408952165`*^9}, {
  3.8208633125824423`*^9, 3.8208633510854483`*^9}, {3.8211085930237284`*^9, 
  3.8211085981273785`*^9}},
 Background->GrayLevel[0.85],
 CellLabel->
  "In[202]:=",ExpressionUUID->"d3fc3727-71f4-4cc8-a873-ac6d233753c5"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", 
    RowBox[{"m", ",", "i"}]], TraditionalForm]],ExpressionUUID->
  "aa5af23b-e412-4afc-a078-446d1bc3a619"],
 " operator"
}], "Text",
 CellChangeTimes->{{3.8208634086206055`*^9, 
  3.820863426186577*^9}},ExpressionUUID->"055e5ba5-f195-4d33-8f99-\
6ab0cd92cb5f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"OpS", "[", 
      RowBox[{"m_", ",", "site_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "depthpos", ",", "jpos", ",", "\[CurlyPhi]aux", ",", "Ueven", ",", 
         "Uodd", ",", "Kop", ",", "j1", ",", "j2"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"depthpos", "=", "m"}], ";", "\[IndentingNewLine]", 
        RowBox[{"jpos", "=", "site"}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[CurlyPhi]aux", "=", 
         RowBox[{"\[CurlyPhi]ansatz", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"depthpos", "-", "1"}], ")"}], "*", "L"}], ")"}], "+",
              "1"}], ";;", 
            RowBox[{"depthpos", "*", "L"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Ueven", ",", "Uodd"}], "}"}], "=", 
         RowBox[{"Us", "[", 
          RowBox[{"\[CurlyPhi]aux", ",", "L"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"j1", "=", "jpos"}], ";", "\[IndentingNewLine]", 
        RowBox[{"j2", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"jpos", "\[Equal]", "L"}], ",", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"jpos", "+", "1"}], ",", "K"}], "]"}], ",", 
           RowBox[{"jpos", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"Kop", "=", 
         RowBox[{
          RowBox[{"KLesser", "[", 
           RowBox[{"depthpos", ",", "\[CurlyPhi]ansatz"}], "]"}], ".", 
          "Ueven", ".", 
          RowBox[{"Heis", "[", 
           RowBox[{"[", 
            RowBox[{"j1", ",", "j2"}], "]"}], "]"}], ".", "Uodd"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"OpS", "[", 
     RowBox[{"m_", ",", "site_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "depthpos", ",", "jpos", ",", "\[CurlyPhi]aux", ",", "Ueven", ",", 
        "Uodd", ",", "Kop", ",", "j1", ",", "j2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"depthpos", "=", "m"}], ";", "\[IndentingNewLine]", 
       RowBox[{"jpos", "=", "site"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[CurlyPhi]aux", "=", 
        RowBox[{"\[CurlyPhi]ansatznum", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"depthpos", "-", "1"}], ")"}], "*", "L"}], ")"}], "+", 
            "1"}], ";;", 
           RowBox[{"depthpos", "*", "L"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Ueven", ",", "Uodd"}], "}"}], "=", 
        RowBox[{"Us", "[", 
         RowBox[{"\[CurlyPhi]aux", ",", "L"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"j1", "=", "jpos"}], ";", "\[IndentingNewLine]", 
       RowBox[{"j2", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"jpos", "\[Equal]", "L"}], ",", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"jpos", "+", "1"}], ",", "L"}], "]"}], ",", 
          RowBox[{"jpos", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Kop", "=", 
        RowBox[{
         RowBox[{"KLesser", "[", 
          RowBox[{"depthpos", ",", "\[CurlyPhi]ansatznum"}], "]"}], ".", 
         "Ueven", ".", 
         RowBox[{"Heis", "[", 
          RowBox[{"[", 
           RowBox[{"j1", ",", "j2"}], "]"}], "]"}], ".", "Uodd"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.820863427750393*^9, 3.8208635699973197`*^9}, {
   3.8208636841979065`*^9, 3.820863753367934*^9}, {3.820863825295596*^9, 
   3.8208638922165203`*^9}, {3.820863932205557*^9, 3.82086402156168*^9}, {
   3.820949108117239*^9, 3.8209491589259243`*^9}, {3.821108623617565*^9, 
   3.821108648831835*^9}, 3.8211126355708294`*^9},
 Background->GrayLevel[0.85],
 CellLabel->
  "In[203]:=",ExpressionUUID->"38a13194-9301-457b-9019-d0f080f32369"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Quotient", "[", 
  RowBox[{"5", ",", "5"}], "]"}]], "Input",
 CellChangeTimes->{{3.8211108238022594`*^9, 3.8211108301764374`*^9}},
 CellLabel->
  "In[204]:=",ExpressionUUID->"99c10bbc-487a-41fa-9ae0-8ce7009315c8"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.8211108309363585`*^9, {3.8213566989896173`*^9, 3.8213567191958447`*^9}, 
   3.8213587375892563`*^9, 3.821361151277007*^9},
 CellLabel->
  "Out[204]=",ExpressionUUID->"4fa1bc27-9bd2-4735-ae42-f996b7b29793"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Convert", "[", 
   RowBox[{"j_", ",", "Lsite_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Totalsites", ",", "jinput", ",", "m", ",", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Totalsites", "=", "Lsite"}], ";", "\[IndentingNewLine]", 
     RowBox[{"jinput", "=", "j"}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"jinput", ",", "Totalsites"}], "]"}], "\[NotEqual]", "0"}], 
        ",", 
        RowBox[{
         RowBox[{"Quotient", "[", 
          RowBox[{"jinput", ",", "Totalsites"}], "]"}], "+", "1"}], ",", 
        RowBox[{"Quotient", "[", 
         RowBox[{"jinput", ",", "Totalsites"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"i", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"jinput", ",", "Totalsites"}], "]"}], "\[NotEqual]", "0"}], 
        ",", 
        RowBox[{"Mod", "[", 
         RowBox[{"jinput", ",", "Totalsites"}], "]"}], ",", "Totalsites"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"m", ",", "i"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8211104322410893`*^9, 3.8211106013971243`*^9}, {
  3.82111074805894*^9, 3.821110771181134*^9}, {3.8211108644929852`*^9, 
  3.8211109256131153`*^9}, {3.821110994822406*^9, 3.8211110723025494`*^9}},
 Background->GrayLevel[0.85],
 CellLabel->
  "In[205]:=",ExpressionUUID->"4a5fa77b-7e46-44ba-9222-56f6c5d76ad2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Convert", "[", 
  RowBox[{"9", ",", "L"}], "]"}]], "Input",
 CellChangeTimes->{{3.8211106506485553`*^9, 3.8211106510458713`*^9}, {
  3.821111088155764*^9, 3.8211111162144766`*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"1aea9730-5a1d-4e65-ab08-c3efe3f5be69"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{{3.8211111017564077`*^9, 3.8211111165610604`*^9}, {
   3.821356699050453*^9, 3.8213567192486763`*^9}, 3.8213587376381273`*^9, 
   3.8213611513278723`*^9},
 CellLabel->
  "Out[206]=",ExpressionUUID->"8d53b9c7-2553-4a46-a691-6905a9da3b62"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["init"], "Input",
 CellChangeTimes->{{3.8208640575524063`*^9, 3.820864058078002*^9}, {
  3.8209491724632053`*^9, 3.8209491733813934`*^9}},
 CellLabel->
  "In[207]:=",ExpressionUUID->"ac493217-281c-45ec-956d-7fd651122030"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.8208640585337796`*^9, 3.8208644846719456`*^9, 3.820949174439323*^9, 
   3.8211086655995607`*^9, {3.8213566990973377`*^9, 3.8213567192865734`*^9}, 
   3.821358737675028*^9, 3.8213611513717537`*^9},
 CellLabel->
  "Out[207]=",ExpressionUUID->"f3704a66-0c18-45d9-b440-d15a0b29ae6c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["\[CurlyPhi]ansatznum"], "Input",
 CellChangeTimes->{{3.82086406924514*^9, 3.8208640717364817`*^9}, {
  3.821108673160281*^9, 3.8211086735292044`*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"a15a4677-713e-43b9-8eda-abdcddd5bc83"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.16910091746246536`", ",", "0.9448821759321522`", ",", 
   "2.8618332925668106`", ",", "2.046109416523233`", ",", 
   "0.4777588309790408`", ",", "5.004223802728816`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.820864072201236*^9, 3.8208644856593056`*^9, 3.820949175838968*^9, 
   3.82110867391327*^9, {3.8213566991402135`*^9, 3.821356719323516*^9}, 
   3.8213587377119284`*^9, 3.821361151382725*^9},
 CellLabel->
  "Out[208]=",ExpressionUUID->"b246f2f0-8be1-4036-9025-73a7bd79c567"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Amatrix", "[", "O_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dim", ",", "A", ",", "vecaux", ",", "ket", ",", "mdepth", ",", "sitei", 
      ",", "Smdag", ",", "Opm", ",", "ketm", ",", "bram", ",", "cm", ",", 
      "ndepth", ",", "sitej", ",", "Sndag", ",", "Opn", ",", "ketn", ",", 
      "bran", ",", "cn"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dim", "=", 
      RowBox[{"L", "*", "\[ScriptCapitalP]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ket", "=", 
      RowBox[{
       RowBox[{"KProd", "[", "\[CurlyPhi]ansatznum", "]"}], ".", "init"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mdepth", ",", "sitei"}], "}"}], "=", 
         RowBox[{"Convert", "[", 
          RowBox[{"i", ",", "L"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Smdag", "=", 
         RowBox[{"ConjugateTranspose", "[", 
          RowBox[{"OpS", "[", 
           RowBox[{"mdepth", ",", "sitei"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Opm", "=", 
         RowBox[{"Smdag", ".", "O"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ketm", "=", 
         RowBox[{
          RowBox[{"KLarger", "[", 
           RowBox[{"mdepth", ",", "\[CurlyPhi]ansatznum"}], "]"}], ".", 
          "init"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bram", "=", 
         RowBox[{"Conjugate", "[", "ketm", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"cm", "=", 
         RowBox[{"Im", "[", 
          RowBox[{"bram", ".", "Opm", ".", "ket"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vecaux", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"ndepth", ",", "sitej"}], "}"}], "=", 
            RowBox[{"Convert", "[", 
             RowBox[{"j", ",", "L"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Sndag", "=", 
            RowBox[{"ConjugateTranspose", "[", 
             RowBox[{"OpS", "[", 
              RowBox[{"ndepth", ",", "sitej"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Opn", "=", 
            RowBox[{"Sndag", ".", "O"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"ketn", "=", 
            RowBox[{
             RowBox[{"KLarger", "[", 
              RowBox[{"ndepth", ",", "\[CurlyPhi]ansatznum"}], "]"}], ".", 
             "init"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"bran", "=", 
            RowBox[{"Conjugate", "[", "ketn", "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"cn", "=", 
            RowBox[{"Im", "[", 
             RowBox[{"bran", ".", "Opn", ".", "ket"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"vecaux", ",", 
             RowBox[{"2", "*", "cm", "*", "cn"}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "dim"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"A", ",", "vecaux"}], "]"}], ";"}], "\[IndentingNewLine]", 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "dim"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "A"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.821108705972378*^9, 3.821108825503215*^9}, {
  3.821110373207943*^9, 3.8211104058900843`*^9}, {3.8211107144208837`*^9, 
  3.821110768589732*^9}, {3.821111132816701*^9, 3.821111198012149*^9}, {
  3.821111424767271*^9, 3.8211116095183396`*^9}, {3.8211116674249*^9, 
  3.8211119141853004`*^9}, {3.8211119516208634`*^9, 3.8211120402865286`*^9}, {
  3.821112435899165*^9, 3.8211124866495223`*^9}, {3.821112732234567*^9, 
  3.821112735249682*^9}},
 Background->GrayLevel[0.85],
 CellLabel->
  "In[209]:=",ExpressionUUID->"eac83125-0100-42f7-9af3-563bbe1a5602"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Ares", "=", 
   RowBox[{"Chop", "[", 
    RowBox[{"Amatrix", "[", 
     RowBox[{"Sz", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Ares", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"Det", "[", "Ares", "]"}]}], "Input",
 CellChangeTimes->{{3.8211120633767905`*^9, 3.821112068909384*^9}, {
  3.821112739106904*^9, 3.8211127738793*^9}, {3.8211129565024476`*^9, 
  3.8211129659031024`*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"8b2c7ef8-b563-469e-a426-1989408a6d08"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"4.240887411946644`", "0", "0.9163582971328712`", 
      RowBox[{"-", "1.3887099497145456`"}], "3.297184822708835`", 
      "3.248770836085231`"},
     {"0", "0", "0", "0", "0", "0"},
     {"0.9163582971328712`", "0", "0.19800396642428486`", 
      RowBox[{"-", "0.3000683020131794`"}], "0.7124458576661288`", 
      "0.701984707904208`"},
     {
      RowBox[{"-", "1.3887099497145456`"}], "0", 
      RowBox[{"-", "0.3000683020131794`"}], "0.45474334428297225`", 
      RowBox[{"-", "1.0796875570063251`"}], 
      RowBox[{"-", "1.063834039004374`"}]},
     {"3.297184822708835`", "0", "0.7124458576661288`", 
      RowBox[{"-", "1.0796875570063251`"}], "2.5634794558508003`", 
      "2.525838781530493`"},
     {"3.248770836085231`", "0", "0.701984707904208`", 
      RowBox[{"-", "1.063834039004374`"}], "2.525838781530493`", 
      "2.4887508014633246`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.821112082880234*^9, 3.821112507525363*^9, 3.821112698802035*^9, {
   3.8211127414771495`*^9, 3.8211127746870823`*^9}, {3.8211129489156833`*^9, 
   3.821112967826587*^9}, {3.8213566992733955`*^9, 3.821356719380332*^9}, 
   3.8213587378505583`*^9, 3.8213611514994125`*^9},
 CellLabel->
  "Out[211]//MatrixForm=",ExpressionUUID->"9976e3bf-b7f7-452a-8884-\
2dedd2d27ed5"],

Cell[BoxData["0.`"], "Output",
 CellChangeTimes->{
  3.821112082880234*^9, 3.821112507525363*^9, 3.821112698802035*^9, {
   3.8211127414771495`*^9, 3.8211127746870823`*^9}, {3.8211129489156833`*^9, 
   3.821112967826587*^9}, {3.8213566992733955`*^9, 3.821356719380332*^9}, 
   3.8213587378505583`*^9, 3.8213611515034018`*^9},
 CellLabel->
  "Out[212]=",ExpressionUUID->"ca320069-b0c3-48fa-bba3-c48a0b131562"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.821359429028216*^9, 3.821359431213693*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"b8b5a054-97ea-48f2-9f57-d2c4f6f7250d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dim", "=", 
    RowBox[{"L", "*", "\[ScriptCapitalP]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ket", "=", 
   RowBox[{
    RowBox[{"KProd", "[", "\[CurlyPhi]ansatznum", "]"}], ".", "init"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"o", " ", "=", " ", 
   RowBox[{"Sz", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ndepth", ",", "sitej"}], "}"}], "=", 
      RowBox[{"Convert", "[", 
       RowBox[{"j", ",", "L"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Sndag", "=", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"OpS", "[", 
        RowBox[{"ndepth", ",", "sitej"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Opn", "=", 
      RowBox[{"Sndag", ".", "o"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ketn", "=", 
      RowBox[{
       RowBox[{"KLarger", "[", 
        RowBox[{"ndepth", ",", "\[CurlyPhi]ansatznum"}], "]"}], ".", 
       "init"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"bran", "=", 
      RowBox[{"Conjugate", "[", "ketn", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"cn", "=", 
      RowBox[{"Im", "[", 
       RowBox[{"bran", ".", "Opn", ".", "ket"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"bran", " ", "//", " ", "MatrixForm"}], "]"}]}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "dim"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8213594054138775`*^9, 3.821359579429817*^9}, {
  3.8213597035627975`*^9, 3.8213597211431923`*^9}, {3.8213599364863563`*^9, 
  3.821359937089676*^9}, {3.821359978896141*^9, 3.821359979954273*^9}},
 CellLabel->
  "In[214]:=",ExpressionUUID->"71c3a32d-5321-46d9-9fa1-00c5c28d316c"],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.11397881307742797`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.25694444532508104`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.1147759260734898`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.8973496170758739`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.09139693493155718`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.3069611278304138`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.821359494054643*^9, {3.821359532749098*^9, 3.821359582450287*^9}, {
   3.821359705418672*^9, 3.8213597219306808`*^9}, 3.8213599378499174`*^9, 
   3.821359980592167*^9, 3.8213611516021447`*^9},
 CellLabel->
  "During evaluation of \
In[214]:=",ExpressionUUID->"26cfe9bc-3c69-494a-81cc-1312ec822261"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.11397881307742797`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.25694444532508104`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.1147759260734898`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.8973496170758739`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.09139693493155718`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.3069611278304138`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.821359494054643*^9, {3.821359532749098*^9, 3.821359582450287*^9}, {
   3.821359705418672*^9, 3.8213597219306808`*^9}, 3.8213599378499174`*^9, 
   3.821359980592167*^9, 3.8213611516071234`*^9},
 CellLabel->
  "During evaluation of \
In[214]:=",ExpressionUUID->"9aefd432-50ca-42bc-81fa-740527f67b4f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.11397881307742797`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.25694444532508104`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.1147759260734898`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.8973496170758739`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.09139693493155718`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.3069611278304138`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
      {
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.821359494054643*^9, {3.821359532749098*^9, 3.821359582450287*^9}, {
   3.821359705418672*^9, 3.8213597219306808`*^9}, 3.8213599378499174`*^9, 
   3.821359980592167*^9, 3.8213611516161003`*^9},
 CellLabel->
  "During evaluation of \
In[214]:=",ExpressionUUID->"f110a80e-6fd3-4f75-bd11-4bf5f1963181"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {"1"},
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {"0"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.821359494054643*^9, {3.821359532749098*^9, 3.821359582450287*^9}, {
   3.821359705418672*^9, 3.8213597219306808`*^9}, 3.8213599378499174`*^9, 
   3.821359980592167*^9, 3.821361151619092*^9},
 CellLabel->
  "During evaluation of \
In[214]:=",ExpressionUUID->"25349c92-77a2-4b8d-bc61-7220c2fcad3c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {"1"},
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {"0"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.821359494054643*^9, {3.821359532749098*^9, 3.821359582450287*^9}, {
   3.821359705418672*^9, 3.8213597219306808`*^9}, 3.8213599378499174`*^9, 
   3.821359980592167*^9, 3.8213611516220837`*^9},
 CellLabel->
  "During evaluation of \
In[214]:=",ExpressionUUID->"ddda9c3a-0b22-430b-b7f5-f4cc217c0878"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {"1"},
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {"0"},
      {"0"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.821359494054643*^9, {3.821359532749098*^9, 3.821359582450287*^9}, {
   3.821359705418672*^9, 3.8213597219306808`*^9}, 3.8213599378499174`*^9, 
   3.821359980592167*^9, 3.8213611516250763`*^9},
 CellLabel->
  "During evaluation of \
In[214]:=",ExpressionUUID->"fda0e988-280a-4afd-8b05-bb1d76360a8b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440., 747.75},
WindowMargins->{{Automatic, 1149.6}, {Automatic, -72}},
FrontEndVersion->"12.2 for Microsoft Windows (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d36b3206-2681-49c8-8e76-bc274993018f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 217, 5, 158, "Title",ExpressionUUID->"42157d35-70ac-4fca-84ed-df6dcd0d8204"],
Cell[800, 29, 223, 5, 53, "Subtitle",ExpressionUUID->"7fe78ad0-52c0-4516-8f38-f54265dfcd27"],
Cell[CellGroupData[{
Cell[1048, 38, 246, 4, 66, "Section",ExpressionUUID->"bb7c3038-a6b7-4ffd-88af-268d2575ecdf"],
Cell[1297, 44, 225, 4, 28, "Input",ExpressionUUID->"f35adfce-c601-4ef0-9f73-f0ee369a01aa"],
Cell[1525, 50, 3672, 95, 347, "Input",ExpressionUUID->"14bb87d6-f6b4-46f3-a741-0236d3ea3d3c"],
Cell[5200, 147, 2541, 38, 44, "Input",ExpressionUUID->"7989c289-b53d-4f67-a91c-c5993f2c9b77"],
Cell[7744, 187, 8988, 218, 816, "Input",ExpressionUUID->"404676b0-d695-4efc-ae43-3ac5a6eee47c"],
Cell[CellGroupData[{
Cell[16757, 409, 215, 4, 28, "Input",ExpressionUUID->"97d2db22-b5d0-401c-818c-a8823edb1db1"],
Cell[16975, 415, 400, 8, 32, "Output",ExpressionUUID->"e27c3960-c48d-4ba3-a2f1-6e24e1db48e8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17412, 428, 217, 4, 28, "Input",ExpressionUUID->"dcc6669e-f919-469c-b239-b9a2dbba1480"],
Cell[17632, 434, 415, 8, 32, "Output",ExpressionUUID->"a29f0d01-3c7a-4cc3-b338-295551c67fac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18084, 447, 183, 3, 28, "Input",ExpressionUUID->"2652949c-95b2-4479-bcbb-aa76782bcaaa"],
Cell[18270, 452, 253, 5, 32, "Output",ExpressionUUID->"0891d354-7ddc-48cf-b721-c4e2bbc53d52"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18572, 463, 336, 5, 66, "Section",ExpressionUUID->"7f1537e8-521d-47b7-8b86-6032be0e685d"],
Cell[18911, 470, 159, 3, 34, "Text",ExpressionUUID->"a996d5c7-90db-4333-8fbd-6472563b0ae8"],
Cell[CellGroupData[{
Cell[19095, 477, 368, 12, 47, "Input",ExpressionUUID->"663bdcfb-7ffe-4057-9616-477249838e11"],
Cell[19466, 491, 402, 8, 32, "Output",ExpressionUUID->"1cbeb9fe-c247-4091-baaa-0f8fc5277543"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19905, 504, 366, 10, 48, "Input",ExpressionUUID->"c7e1a9f2-dc29-43de-a9f5-47b377f13a69"],
Cell[20274, 516, 462, 10, 32, "Output",ExpressionUUID->"0cc90413-e3f7-4e6c-802e-5e5e243d70e5"]
}, Open  ]],
Cell[20751, 529, 216, 4, 34, "Text",ExpressionUUID->"402f7af6-69a1-495f-8560-7eee936118be"],
Cell[20970, 535, 349, 7, 44, "Input",ExpressionUUID->"ff4bce30-b864-4c0b-b75b-734f519b11f0"],
Cell[21322, 544, 757, 20, 36, "Text",ExpressionUUID->"c0e15427-38a9-4da9-a34b-440e1c9bf266"],
Cell[22082, 566, 1555, 40, 120, "Input",ExpressionUUID->"45ec5aad-bed9-4bbd-b6f9-6fce9f7c6ba0"],
Cell[CellGroupData[{
Cell[23662, 610, 357, 8, 44, "Input",ExpressionUUID->"129da94f-0e34-4bd7-9185-4cd39614d5f8"],
Cell[24022, 620, 597, 13, 32, "Output",ExpressionUUID->"ea9caca9-5abc-4aee-8bd4-a41eb117c4fb"]
}, Open  ]],
Cell[24634, 636, 619, 19, 34, "Text",ExpressionUUID->"669ab323-ac37-4d32-8bdc-3f7bab7a39db"],
Cell[25256, 657, 4378, 109, 291, "Input",ExpressionUUID->"3b3b9462-ce50-4b91-8e12-fd2e4d3bd438"],
Cell[29637, 768, 7175, 177, 685, "Input",ExpressionUUID->"48939c7a-8801-4d2b-9b38-4a40b5da7913"],
Cell[36815, 947, 152, 3, 35, "Text",ExpressionUUID->"c2f9bcf3-c2dc-4eb9-8a27-3b6a29b1ffb5"],
Cell[36970, 952, 411, 12, 35, "Text",ExpressionUUID->"3c4faf29-722b-4c40-bf42-77f08fb68326"],
Cell[CellGroupData[{
Cell[37406, 968, 350, 7, 28, "Input",ExpressionUUID->"0405623c-df5f-40b8-8273-0b155fa6e143"],
Cell[37759, 977, 510, 11, 32, "Output",ExpressionUUID->"e3ec365e-ffd5-47aa-b66e-f9d32b91911d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38306, 993, 705, 17, 64, "Input",ExpressionUUID->"bd380713-8af7-4517-9258-81e4e7d294a6"],
Cell[39014, 1012, 1239, 25, 32, "Output",ExpressionUUID->"07e20def-8d54-483a-9001-cbfe92147c61"]
}, Open  ]],
Cell[40268, 1040, 432, 14, 37, "Text",ExpressionUUID->"35ea4647-5e38-49a2-9404-53aafd4dd6f1",
 InitializationCell->True],
Cell[40703, 1056, 782, 22, 63, "Input",ExpressionUUID->"d3fc3727-71f4-4cc8-a873-ac6d233753c5"],
Cell[41488, 1080, 324, 10, 35, "Text",ExpressionUUID->"055e5ba5-f195-4d33-8f99-6ab0cd92cb5f"],
Cell[41815, 1092, 4353, 112, 389, "Input",ExpressionUUID->"38a13194-9301-457b-9019-d0f080f32369"],
Cell[CellGroupData[{
Cell[46193, 1208, 237, 5, 28, "Input",ExpressionUUID->"99c10bbc-487a-41fa-9ae0-8ce7009315c8"],
Cell[46433, 1215, 258, 5, 32, "Output",ExpressionUUID->"4fa1bc27-9bd2-4735-ae42-f996b7b29793"]
}, Open  ]],
Cell[46706, 1223, 1671, 43, 157, "Input",ExpressionUUID->"4a5fa77b-7e46-44ba-9222-56f6c5d76ad2"],
Cell[CellGroupData[{
Cell[48402, 1270, 287, 6, 28, "Input",ExpressionUUID->"1aea9730-5a1d-4e65-ab08-c3efe3f5be69"],
Cell[48692, 1278, 330, 7, 32, "Output",ExpressionUUID->"8d53b9c7-2553-4a46-a691-6905a9da3b62"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49059, 1290, 234, 4, 28, "Input",ExpressionUUID->"ac493217-281c-45ec-956d-7fd651122030"],
Cell[49296, 1296, 443, 10, 32, "Output",ExpressionUUID->"f3704a66-0c18-45d9-b440-d15a0b29ae6c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49776, 1311, 247, 4, 28, "Input",ExpressionUUID->"a15a4677-713e-43b9-8eda-abdcddd5bc83"],
Cell[50026, 1317, 528, 11, 32, "Output",ExpressionUUID->"b246f2f0-8be1-4036-9025-73a7bd79c567"]
}, Open  ]],
Cell[50569, 1331, 4364, 99, 570, "Input",ExpressionUUID->"eac83125-0100-42f7-9af3-563bbe1a5602"],
Cell[CellGroupData[{
Cell[54958, 1434, 576, 14, 66, "Input",ExpressionUUID->"8b2c7ef8-b563-469e-a426-1989408a6d08"],
Cell[55537, 1450, 1707, 39, 130, "Output",ExpressionUUID->"9976e3bf-b7f7-452a-8884-2dedd2d27ed5"],
Cell[57247, 1491, 408, 7, 32, "Output",ExpressionUUID->"ca320069-b0c3-48fa-bba3-c48a0b131562"]
}, Open  ]],
Cell[57670, 1501, 175, 3, 28, "Input",ExpressionUUID->"b8b5a054-97ea-48f2-9f57-d2c4f6f7250d"],
Cell[CellGroupData[{
Cell[57870, 1508, 1998, 52, 272, "Input",ExpressionUUID->"71c3a32d-5321-46d9-9fa1-00c5c28d316c"],
Cell[CellGroupData[{
Cell[59893, 1564, 1765, 46, 139, "Print",ExpressionUUID->"26cfe9bc-3c69-494a-81cc-1312ec822261"],
Cell[61661, 1612, 1765, 46, 139, "Print",ExpressionUUID->"9aefd432-50ca-42bc-81fa-740527f67b4f"],
Cell[63429, 1660, 1765, 46, 139, "Print",ExpressionUUID->"f110a80e-6fd3-4f75-bd11-4bf5f1963181"],
Cell[65197, 1708, 920, 30, 131, "Print",ExpressionUUID->"25349c92-77a2-4b8d-bc61-7220c2fcad3c"],
Cell[66120, 1740, 922, 30, 131, "Print",ExpressionUUID->"ddda9c3a-0b22-430b-b7f5-f4cc217c0878"],
Cell[67045, 1772, 922, 30, 131, "Print",ExpressionUUID->"fda0e988-280a-4afd-8b05-bb1d76360a8b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

